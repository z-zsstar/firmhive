{"name": "hotplug-command-injection", "location": "sbin/hotplug:fcn.004013a0", "risk_score": 8.0, "confidence": 7.25, "description": "The sbin/hotplug program contains multiple unfiltered system calls for executing system commands (cp, rm, echo). These commands use parameters derived from device paths, which could potentially lead to command injection vulnerabilities if these paths can be externally controlled.", "code_snippet": "sym.imp.snprintf(auStack_1b0,0x100,\"rm -rf /var/run/usb_device_host%d\",auStack_b0[0]);\nsym.imp.system(auStack_1b0);", "link_identifiers": ["system", "cp -pR", "rm -rf", "echo", "/var/run/usb_device_host%d"], "notes": "Further confirmation is required to determine whether the device path parameter could be externally controlled."}
{"name": "hotplug-file-operations", "location": "sbin/hotplug:fcn.00401a28", "risk_score": 6.5, "confidence": 7.0, "description": "The program involves operations on sensitive files, including /proc/tplink/led_usb and /var/run/storage_led_status, which could be exploited to affect system state.", "code_snippet": "sym.imp.snprintf(auStack_110,0x100,\"echo %d %d > %s\",*&iStackX_0,uStackX_4,\"/proc/tplink/led_usb\");\nsym.imp.system(auStack_110);", "link_identifiers": ["/proc/tplink/led_usb", "/var/run/storage_led_status", "fopen", "flock"], "notes": "Parameters have range checks, but the calling path still needs to be verified."}
