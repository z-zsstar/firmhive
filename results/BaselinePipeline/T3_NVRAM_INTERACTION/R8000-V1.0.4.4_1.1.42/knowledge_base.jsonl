{"name": "acos_service-NVRAM-command_injection", "file_path": "sbin/acos_service", "location": "sbin/acos_service:0x16d44-0x17bb4", "risk_score": 8.5, "confidence": 8.0, "description": "The function fcn.000184c makes multiple calls to getenv to retrieve environment variables, which are then used for network configuration and system command execution. Some environment variable values are directly incorporated into system command construction (via system calls), posing a command injection risk. If these environment variables are maliciously controlled, it could lead to arbitrary command execution.", "code_snippet": "N/A", "link_identifiers": ["fcn.0001849c", "getenv", "system", "ifconfig", "route_add", "route_del"], "notes": "It is recommended to strictly validate all external inputs."}
{"name": "acos_service-NVRAM-config_access", "file_path": "sbin/acos_service", "location": "sbin/acos_service:HIDDEN", "risk_score": 7.0, "confidence": 7.25, "description": "Multiple NVRAM configuration operations (acosNvramConfig_set/get) have been detected for storing and retrieving network configuration parameters. Some parameters are used directly without validation, which may lead to configuration tampering or information leakage.", "code_snippet": "N/A", "link_identifiers": ["acosNvramConfig_set", "acosNvramConfig_get", "acosNvramConfig_match", "acosNvramConfig_read"], "notes": "NVRAM operations should include permission checks and input validation."}
{"name": "busybox-PATH_injection", "file_path": "bin/busybox", "location": "bin/busybox:0x51670", "risk_score": 7.0, "confidence": 7.25, "description": "A getenv call was found in function fcn.00050ee0 to retrieve the PATH environment variable. This value is used for command lookup, posing a path injection risk. The PATH environment variable is utilized for command lookup and could be hijacked to execute malicious programs.", "code_snippet": "N/A", "link_identifiers": ["fcn.00050ee0", "sym.imp.getenv", "PATH"], "notes": "Validate the PATH value."}
{"name": "leafp2p-NVRAM-path_control", "file_path": "etc/init.d/leafp2p.sh", "location": "etc/init.d/leafp2p.sh:5", "risk_score": 6.5, "confidence": 7.0, "description": "A vulnerability was discovered in the leafp2p.sh script where the `leafp2p_sys_prefix` environment variable is obtained via `nvram get`, and this value is used to construct subsequent command paths. If this variable is maliciously modified, it could lead to the execution of scripts from unintended paths.", "code_snippet": "N/A", "link_identifiers": ["nvram", "leafp2p_sys_prefix", "CHECK_LEAFNETS"], "notes": "It is recommended to verify the source and integrity of the leafp2p_sys_prefix value"}
{"name": "remote-NVRAM-multi_config", "file_path": "etc/init.d/remote.sh", "location": "etc/init.d/remote.sh", "risk_score": 8.0, "confidence": 8.25, "description": "The remote.sh script contains extensive NVRAM operations, including retrieving and setting multiple leafp2p-related configuration variables. These variables control critical functions such as remote access, debug levels, and firewall settings. The lack of input validation may pose security risks.", "code_snippet": "N/A", "link_identifiers": ["leafp2p_sys_prefix", "leafp2p_replication_url", "leafp2p_replication_hook_url", "leafp2p_remote_url", "leafp2p_debug", "leafp2p_firewall", "leafp2p_rescan_devices", "leafp2p_services", "leafp2p_service_0", "leafp2p_run", "nvram get", "nvram set", "nvram commit"], "notes": "These NVRAM variables control critical network functions; it is recommended to review all relevant URLs and configuration values."}
{"name": "httpd-NVRAM-config_check", "file_path": "usr/sbin/httpd", "location": "usr/sbin/httpd:fcn.000384a0", "risk_score": 5.0, "confidence": 5.5, "description": "The check operation on NVRAM configuration is detected, verifying configuration matching through the function `acosNvramConfig_match`. This check may involve sensitive configuration validation, but specific configuration item names require further confirmation through string analysis.", "code_snippet": "N/A", "link_identifiers": ["acosNvramConfig_match", "0x38df0", "0x38df4"], "notes": "Further analysis is required on the string content referenced by 0x38df0 and 0x38df4."}
{"name": "httpd-command_injection", "file_path": "usr/sbin/httpd", "location": "usr/sbin/httpd:fcn.000384a0", "risk_score": 8.0, "confidence": 7.0, "description": "Direct system command execution (`system` call) detected, where some commands may incorporate data from environment variables. Command injection risk exists, particularly when processing user-controllable inputs.", "code_snippet": "N/A", "link_identifiers": ["system", "0x38e08", "0x38e68", "0x38e70", "0x38e84", "0x38e94"], "notes": "Need to confirm whether these system calls use unvalidated user input"}
