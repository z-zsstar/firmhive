{"name": "command-injection-param.cgi-system", "file_path": "web/cgi-bin/cgi/param.cgi", "location": "web/cgi-bin/cgi/param.cgi (HIDDEN)", "risk_score": 9.5, "confidence": 8.75, "description": "Multiple instances of direct calls to the system() function were found in param.cgi, where command strings are partially constructed from HTTP parameters. Attackers can inject arbitrary commands by crafting malicious parameters, particularly when handling configuration items such as System.Info, Network, and SMTP, which directly execute commands like service restarts.", "code_snippet": "N/A (HIDDEN)", "link_identifiers": ["system", "/usr/sbin/msger", "/etc/init.d/", "System.Info", "Network", "SMTP"], "notes": "Special attention must be paid to the risk of command injection when handling parameters such as System.Info and Network."}
{"name": "buffer-overflow-httpd-strcpy", "file_path": "web/httpd", "location": "web/httpd:0x403fc4", "risk_score": 9.0, "confidence": 8.5, "description": "A buffer overflow vulnerability was identified in the web/httpd component due to the use of the unsafe strcpy function when processing parameters in HTTP requests. At address 0x00403fc4, strcpy is used to copy the peer address into a buffer without verifying the size of the destination buffer.", "code_snippet": "N/A (HIDDEN)", "link_identifiers": ["strcpy", "skGetPeer6", "var_28h"], "notes": "An attacker may trigger a buffer overflow by crafting a specially designed HTTP request"}
{"name": "command-injection-dcp_class3_handler-sprintf", "file_path": "mydlink/dcp", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 8.5, "confidence": 7.75, "description": "Command injection vulnerability was identified in the dcp_class3_handler function where unvalidated external input is used to construct system command strings. Attackers could inject malicious commands through specially crafted HTTP requests. The function employs sprintf to build command strings, creating potential command injection risks.", "code_snippet": "(**(loc._gp + -0x7d34))(iVar12,0x1000,\"3;M=%s;D=%s;R=%d;0=%c;1=%s;2=%s;3=%s;4=%s;5=%s;6=%c;7=%s;8=%s;9=%c;10=%c;11=%s;14=%c;15=%c;18=%s;23=%s;24=%s;25=%s;26=%s;27=%s;50=%s;51=%s\",param_2 + 200,param_2 + 0x84,1,uStack_74,puStack_6c,puStack_68,puStack_64,puStack_60,puStack_70,iStack_48,puStack_7c,puStack_8c,iStack_3c,iStack_40,puStack_80,iStack_44,iStack_38,puStack_90,puStack_50,puStack_4c,puStack_5c,puStack_58,puStack_54,auStack_1ad0,auStack_1ac8);", "link_identifiers": ["dcp_class3_handler", "sprintf", "system_shell_cmd"], "notes": "Ensure all input parameters are properly validated and escaped"}
{"name": "buffer-overflow-param.cgi-strncpy", "file_path": "web/cgi-bin/cgi/param.cgi", "location": "web/cgi-bin/cgi/param.cgi (HIDDEN)", "risk_score": 7.5, "confidence": 7.5, "description": "The program uses unsafe functions like strncpy to handle user input, posing a risk of buffer overflow. Particularly when processing long fields such as OverlayText and FriendlyName, it may lead to memory corruption.", "code_snippet": "N/A (HIDDEN)", "link_identifiers": ["strncpy", "OverlayText", "FriendlyName", "ServerName", "ESSID"], "notes": "Check the boundary conditions for all string handling functions"}
{"name": "command-injection-hnap_service-system", "file_path": "web/cgi-bin/hnap/hnap_service", "location": "web/cgi-bin/hnap/hnap_service:main", "risk_score": 8.5, "confidence": 8.0, "description": "The main function was found to directly use system calls to execute commands, including actions such as resetting WiFi and restarting the HTTPS service. These commands are triggered via HTTP requests, posing a risk of command injection.", "code_snippet": "N/A (HIDDEN)", "link_identifiers": ["system", "/usr/sbin/msger", "/etc/init.d/https-0 restart", "/usr/sbin/set_passwd"], "notes": "Verify whether all system calls have properly filtered user input"}
{"name": "buffer-overflow-dcp_class7_handler-strcpy", "file_path": "mydlink/dcp", "location": "mydlink/dcp:0x0040829c sym.dcp_class7_handler", "risk_score": 8.0, "confidence": 7.75, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "(**(loc._gp + -0x7e7c))(auStack_12c8,iVar6,0x9c);\n(**(loc._gp + -0x7d64))(auStack_12c8);", "link_identifiers": ["dcp_class7_handler", "strcpy", "strncpy"], "notes": "buffer_overflow"}
{"name": "ssrf-dcp_class8_handler-dns_query", "file_path": "mydlink/dcp", "location": "mydlink/dcp:0x00407e2c sym.dcp_class8_handler", "risk_score": 7.0, "confidence": 6.75, "description": "The dcp_class8_handler function contains DNS query functionality, which could be exploited for SSRF attacks. Attackers can control the target hostname being queried.", "code_snippet": "iVar1 = (**(loc._gp + -0x7ec4))(pcVar5,uVar2);", "link_identifiers": ["dcp_class8_handler", "DNS_query", "SSRF"], "notes": "Implement whitelist restrictions for allowed hostname queries."}
