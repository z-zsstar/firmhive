{"name": "NVRAM-REDACTED_SECRET_KEY_PLACEHOLDER-sbin-init", "file_path": "sbin/init", "location": "sbin/init:fcn.0000ed80", "risk_score": 9.0, "confidence": 7.75, "description": "Multiple command injection vulnerabilities were discovered in sbin/init, where NVRAM values were directly used in system() calls without proper sanitization. Attackers could execute arbitrary commands during system initialization by tampering with NVRAM values. This vulnerability is triggered when the rc process reads and executes malicious NVRAM values, potentially leading to complete system compromise.", "code_snippet": "system(nvram_get(\"malicious_config\"));", "link_identifiers": ["system", "nvram_get", "nvram_set", "strcmp", "eval"], "notes": "command_injection"}
{"name": "SSRF-genie.cgi-www-cgi-bin", "file_path": "www/cgi-bin/genie.cgi", "location": "www/cgi-bin/genie.cgi:fcn.0000a764", "risk_score": 8.5, "confidence": 7.5, "description": "Server-Side Request Forgery (SSRF) vulnerability in www/cgi-bin/genie.cgi where the script makes HTTP requests using curl with potentially user-controlled data from QUERY_STRING. This could be exploited to make arbitrary HTTP requests from the server, potentially accessing internal services or bypassing firewall restrictions.", "code_snippet": "curl_easy_setopt(curl, CURLOPT_URL, nvram_get(\"proxy_url\"));", "link_identifiers": ["curl_easy_perform", "curl_easy_setopt", "QUERY_STRING", "nvram_get"], "notes": "ssrf"}
{"name": "BufferOverflow-nvram-sbin", "file_path": "usr/sbin/nvram", "location": "usr/sbin/nvram:0x000088e8", "risk_score": 8.0, "confidence": 7.0, "description": "buffer_overflow", "code_snippet": "strncpy(buffer, nvram_value, 0x20000);", "link_identifiers": ["strncpy", "nvram_set", "0x20000"], "notes": "buffer_overflow"}
{"name": "REDACTED_SECRET_KEY_PLACEHOLDER-genie.cgi-www-cgi-bin", "file_path": "www/cgi-bin/genie.cgi", "location": "www/cgi-bin/genie.cgi:fcn.0000ac68", "risk_score": 9.0, "confidence": 7.75, "description": "command_injection", "code_snippet": "popen(nvram_get(\"remote_command\"), \"r\");", "link_identifiers": ["popen", "nvram_get", "QUERY_STRING", "system"], "notes": "command_injection"}
{"name": "NVRAM-Injection-libnvram", "file_path": "usr/lib/libnvram.so", "location": "usr/lib/libnvram.so", "risk_score": 8.5, "confidence": 6.75, "description": "nvram_injection", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["nvram_set", "nvram_get", "acosNvramConfig_set", "acosNvramConfig_get", "/dev/nvram"], "notes": "nvram_injection"}
{"name": "SymbolicLink-etc-init.d-remote", "file_path": "etc/init.d/remote.sh", "location": "etc/init.d/remote.sh:10-18", "risk_score": 7.5, "confidence": 7.5, "description": "directory_traversal", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["REDACTED_SENSITIVE_DATA", "REDACTED_SENSITIVE_DATA", "REDACTED_SENSITIVE_DATA", "REDACTED_SENSITIVE_DATA"], "notes": "directory_traversal"}
{"name": "RouterRemote-Service-etc-init.d-remote", "file_path": "etc/init.d/remote.sh", "location": "etc/init.d/remote.sh:50-58", "risk_score": 8.5, "confidence": 8.0, "description": "network_service", "code_snippet": "nvram set leafp2p_service_0=\"RouterRemote,0,1,1,1,1,6:135,6:136,6:137,6:138,6:139,6:445,6:548,17:135,17:136,17:137,17:138,17:139,17:445,17:548\"", "link_identifiers": ["leafp2p_services", "leafp2p_service_0", "RouterRemote,0,1,1,1,1,6:135,6:136,6:137,6:138,6:139,6:445,6:548,17:135,17:136,17:137,17:138,17:139,17:445,17:548"], "notes": "network_service"}
{"name": "System-Command-Injection-sbin-system", "file_path": "sbin/system", "location": "sbin/system:0xd1b8", "risk_score": 9.0, "confidence": 7.25, "description": "command_injection", "code_snippet": "system(\"nvram set gbsd_msglevel=0x800003ff\");", "link_identifiers": ["system", "nvram set gbsd_msglevel=0x800003ff", "libnvram.so"], "notes": "command_injection"}
