{"name": "buffer-overflow-nvram-config-set", "file_path": "bin/nvram", "location": "bin/nvram:0x8b50", "risk_score": 7.2, "confidence": 7.15, "description": "A buffer overflow vulnerability was discovered in the fcn.00008b50 function of bin/nvram. When processing the `config set name=value` command, an overflow may occur if the value parameter is excessively long. Attackers can trigger this vulnerability by crafting specially constructed name=value parameters. Trigger condition: The attacker is capable of sending or injecting config set commands. Potential impact: Arbitrary code execution or system crash.", "code_snippet": "iVar1 = sym.imp.strlen();\niVar1 = iVar1 + 0;\nif ((iVar1 != 0) && (*(param_1 + iVar1 + -1) == '\r')) {\n    iVar1 = iVar1 + -1;\n}", "link_identifiers": ["fcn.00008b50", "strlen", "config set", "name=value"], "notes": "Further analysis of the specific implementation of the config set command is required to confirm exploitability of the vulnerability."}
{"name": "command-injection-ntgr_sw_api-eval", "file_path": "etc/scripts/ntgr_sw_api/ntgr_sw_api.sh", "location": "etc/scripts/ntgr_sw_api/ntgr_sw_api.sh:30,46", "risk_score": 8.5, "confidence": 8.0, "description": "A command injection vulnerability was discovered in the eval command within etc/scripts/ntgr_sw_api/ntgr_sw_api.sh. The script uses eval to process content obtained from configuration files (SWAPI_PERSISTENT_CONN or MINIDLNA_CONF). If an attacker can control these configuration values, it may lead to command injection. Trigger condition: The attacker can modify relevant NVRAM configuration values. Potential impact: Remote code execution.", "link_identifiers": ["eval", "SWAPI_PERSISTENT_CONN", "MINIDLNA_CONF", "ntgr_sw_api.sh"], "notes": "It is necessary to confirm whether these configuration values can be modified through network interfaces or other external inputs."}
{"name": "strcpy-buffer-overflow-proccgi", "file_path": "www/cgi-bin/proccgi", "location": "www/cgi-bin/proccgi:0x888c", "risk_score": 8.0, "confidence": 8.25, "description": "An insecure strcpy call was found in www/cgi-bin/proccgi, which may lead to buffer overflow. This function is used to process input strings. Although memory allocation is performed, strict length validation is lacking. Attackers can exploit this vulnerability through carefully crafted input. Trigger condition: attackers can control input parameters. Potential impact: arbitrary code execution or service crash.", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["proccgi", "strcpy", "REDACTED_SENSITIVE_DATA", "malloc"], "notes": "Further analysis of input sources and call paths is required to identify the attack surface."}
{"name": "firewall-rule-injection-net-wall", "file_path": "usr/sbin/net-wall", "location": "usr/sbin/net-wall (HIDDEN)", "risk_score": 9.0, "confidence": 7.75, "description": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["strcpy", "system", "ioctl", "REDACTED_SENSITIVE_DATA", "wan_proto", "wan_ifname"], "notes": "Check if the script parameters are properly filtered"}
{"name": "dynamic-rule-execution-firewall-sh", "file_path": "REDACTED_SENSITIVE_DATA", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 8.5, "confidence": 8.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "ls ${LIBDIR}/*.rule | while read rule\ndo\n\t$SHELL $rule start\ndone", "link_identifiers": ["LIBDIR", "firewall_start", "firewall_stop", ".rule", "$SHELL $rule"], "notes": "Check the permissions and potential write points of the ${LIBDIR} directory. Recommendations: 1) Perform signature verification on .rule files 2) Restrict directory write permissions"}
{"name": "firewall-config-injection-ntgr_sw_api-rule", "file_path": "REDACTED_SENSITIVE_DATA", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 7.0, "confidence": 7.0, "description": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["config get", "iptables -I INPUT", "iptables -I OUTPUT", "FIREWALL_NVCONF_PREFIX", "set $value"], "notes": "The attacker needs to first obtain write permissions to the configuration system to exploit this vulnerability."}
{"name": "unsafe-string-operations-bin-config", "file_path": "bin/config", "location": "bin/config", "risk_score": 8.5, "confidence": 7.25, "description": "Multiple dangerous string operations (strcpy, sprintf) were identified in bin/config, which may lead to buffer overflow vulnerabilities when used with untrusted input. These functions are invoked within the configuration management logic, particularly surrounding 'config set' operations. Trigger condition: An attacker can supply malicious configuration values. Potential impact: Arbitrary code execution.", "link_identifiers": ["strcpy", "sprintf", "config_set", "config_get"], "notes": "Vulnerability confirmation requires dynamic analysis to validate input verification."}
