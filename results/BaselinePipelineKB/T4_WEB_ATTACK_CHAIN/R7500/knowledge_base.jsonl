{"name": "vulnerability-cgi-strcpy-000087c8", "location": "www/cgi-bin/proccgi:0x87f0 fcn.000087c8", "risk_score": 8.5, "confidence": 8.25, "description": "An unsafe strcpy call was identified in the fcn.000087c8 function, which processes user input parameters. The function first retrieves the input length and allocates memory, but copies data using strcpy without boundary checks, potentially leading to a buffer overflow vulnerability. Attackers could exploit this vulnerability by crafting malicious HTTP parameters.", "code_snippet": "sym.imp.strcpy(iVar1,param_1);", "link_identifiers": ["fcn.000087c8", "strcpy", "malloc", "strlen", "proccgi", "HTTP_parameter"], "notes": "Further verification is required to determine the source of param_1, which may be obtained through getenv as an HTTP parameter."}
{"name": "vulnerability-cgi-REDACTED_SECRET_KEY_PLACEHOLDER-00008ac0", "location": "www/cgi-bin/proccgi:0x8ac0 fcn.00008ac0", "risk_score": 7.0, "confidence": 7.25, "description": "In the fcn.00008ac0 function, HTTP parameter processing logic was identified. This function may retrieve user input (such as QUERY_STRING) through environment variables. The function includes handling of special characters (e.g., $, \", `, \\), but fails to completely filter all dangerous characters, potentially leading to command injection vulnerabilities.", "code_snippet": "if (uVar4 == 0x24) {... sym.imp.fputc(0x5c); ...}", "link_identifiers": ["fcn.00008ac0", "getenv", "fprintf", "fputc", "QUERY_STRING", "command_injection", "proccgi"], "notes": "It is necessary to confirm whether all dangerous characters have been properly handled, especially when parameters are used in system commands."}
{"name": "vulnerability-cgi-getenv-000085dc", "location": "www/cgi-bin/proccgi:0x85dc sym.imp.getenv", "risk_score": 7.5, "confidence": 7.0, "description": "The program uses getenv to retrieve environment variables, but it does not confirm whether they are used to obtain HTTP request parameters (such as QUERY_STRING). If these values are used directly without adequate validation, it may lead to various injection attacks.", "link_identifiers": ["getenv", "QUERY_STRING", "HTTP_parameter", "proccgi"], "notes": "It is necessary to track the usage of the return value of getenv to confirm specific risks."}
{"name": "vulnerability-cgi-eval-0001", "location": "www/cgi-bin/RMT_invite.cgi:3", "risk_score": 9.0, "confidence": 8.0, "description": "The script uses eval to execute the output of proccgi, which may lead to command injection. proccgi processes HTTP request parameters, and its output is directly passed to eval, allowing attackers to potentially inject arbitrary commands by crafting malicious HTTP parameters.", "code_snippet": "eval \"`/www/cgi-bin/proccgi $*`\"", "link_identifiers": ["eval", "proccgi", "$*", "RMT_invite.cgi", "command_injection"], "notes": "Further analysis of the proccgi script is required to confirm the parameter handling method."}
{"name": "vulnerability-cgi-formparams-0002", "location": "www/cgi-bin/RMT_invite.cgi:10-40", "risk_score": 8.5, "confidence": 8.5, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["FORM_TXT_remote_login", "FORM_TXT_remote_passwd", "FORM_change_wan_pppoe_demand", "nvram", "RMT_invite.cgi", "configuration_tampering"], "notes": "Attackers may alter system configurations or execute arbitrary commands by crafting malicious inputs."}
{"name": "vulnerability-cgi-httphost-0003", "location": "www/cgi-bin/RMT_invite.cgi:48", "risk_score": 6.5, "confidence": 6.75, "description": "The HTTP_HOST environment variable is used directly without validation, which may lead to HTTP response header injection or other security issues.", "code_snippet": "HTTP_URL=`echo ${HTTP_HOST}`", "link_identifiers": ["HTTP_HOST", "HTTP_URL", "RMT_invite.cgi", "header_injection"], "notes": "Although the risk is low, it is still recommended to validate HTTP_HOST."}
{"name": "vulnerability-ozker-sprintf-000123b8", "location": "usr/sbin/ozker:0x124c4 (fcn.000123b8)", "risk_score": 8.0, "confidence": 7.25, "description": "A formatting string vulnerability was identified in the sprintf call within function fcn.000123b8. This function processes JSON object input without adequate validation of input string length, potentially leading to buffer overflow. Attackers could exploit this vulnerability by crafting malicious JSON requests.", "code_snippet": "iVar6 = sym.imp.sprintf(iVar11,*0x1259c);", "link_identifiers": ["fcn.000123b8", "json_object_get", "json_string_value", "sprintf", "ozker", "JSON_injection"], "notes": "Further verification is needed to determine whether the input source includes HTTP request parameters."}
{"name": "vulnerability-ozker-strcpy-0000ddf4", "location": "usr/sbin/ozker:0xde74,0xdef4 (fcn.0000ddf4)", "risk_score": 8.5, "confidence": 8.0, "description": "Multiple strcpy calls in function fcn.0000ddf4 pose buffer overflow risks. This function handles path string concatenation without checking the destination buffer size, potentially leading to memory corruption. Attackers could exploit this vulnerability by manipulating input path parameters.", "code_snippet": "sym.imp.strcpy(pcVar6 + 0x30,iVar7);\nsym.imp.strcpy(iVar7,param_2);", "link_identifiers": ["fcn.0000ddf4", "strcpy", "strlen", "malloc", "ozker", "path_manipulation"], "notes": "parameters may come from path parameters in an HTTP request"}
{"name": "vulnerability-ozker-system-0x121bc", "location": "usr/sbin/ozker:0x121bc", "risk_score": 9.5, "confidence": 6.25, "description": "At address 0x121bc, a system function call was identified, posing a command injection risk. Further analysis of the calling context is required to confirm whether unvalidated user input is being used as command parameters.", "code_snippet": "bl sym.imp.system", "link_identifiers": ["system", "0x121bc", "ozker", "command_injection"], "notes": "Decompile the function at 0x121bc to confirm the input source"}
{"name": "vulnerability-ozker-json-0000", "location": "usr/sbin/ozker", "risk_score": 7.5, "confidence": 7.25, "description": "The global discovery process extensively utilizes JSON parsing functions to handle input, but lacks sufficient input validation. Multiple JSON processing paths ultimately flow into dangerous functions, posing potential injection risks.", "link_identifiers": ["json_object_get", "json_string_value", "json_integer_value", "ozker", "JSON_injection"], "notes": "It is recommended to strictly validate and filter all JSON inputs."}
{"name": "observation-empty-cgi-files", "location": "www/apply.cgi, www/func.cgi, www/recover.cgi", "risk_score": 0.0, "confidence": 4.75, "description": "All inspected web service component CGI files (including apply.cgi, func.cgi, recover.cgi, etc.) are empty files (0 bytes). This indicates possible: 1) File system corruption 2) These are invalid placeholder files 3) The actual web components have been removed. Since there is no analyzable binary content, further vulnerability analysis cannot be conducted.", "link_identifiers": ["www/apply.cgi", "www/func.cgi", "www/recover.cgi", "empty_cgi"], "notes": "Suggestions: 1) Verify firmware integrity 2) Search for other web service components 3) Confirm whether these empty files are dynamically populated by other components during runtime"}
{"name": "observation-uhttpd-script-analysis", "location": "www/cgi-bin/uhttpd.sh", "risk_score": 0.0, "confidence": 4.75, "description": "The target file www/cgi-bin/uhttpd.sh is a service control script and does not directly handle HTTP requests. Its primary function is to start/stop the uhttpd service, with no observed direct processing of HTTP parameters or invocation of dangerous functions. The actual HTTP request handling logic likely resides in the following locations:\n1. /usr/sbin/uhttpd (main web server binary)\n2. Other CGI scripts under /www/cgi-bin/\n3. /usr/sbin/fw-checking (invoked checking utility)", "link_identifiers": ["UHTTPD_BIN", "FW_CHECK_BIN", "uhttpd_start", "uhttpd_stop", "net-cgi", "service_script"], "notes": "The current script does not include web request handling logic. Analysis of the uhttpd binary and other CGI scripts is required to complete the task of identifying vulnerabilities in user requests."}
{"name": "vulnerability-uhttpd-strcpy-uh_cgi_request", "location": "usr/sbin/uhttpd: sym.uh_cgi_request", "risk_score": 8.5, "confidence": 7.75, "description": "In the uh_cgi_request function, the strcpy function is found to be directly used for copying user-controllable HTTP input data. This operation occurs within the CGI request processing flow, where HTTP request parameters are copied into a buffer without length verification, potentially leading to a buffer overflow vulnerability.", "code_snippet": "sym.imp.strcpy(puVar21 + 0xffffda2c, puVar21 + 0xffffca35);", "link_identifiers": ["strcpy", "uh_cgi_request", "acStack_55f8", "acStack_45f8", "buffer_overflow", "HTTP_parameter"], "notes": "Further confirmation is required regarding the target buffer size and the maximum possible length of the input data."}
{"name": "vulnerability-uhttpd-system-uh_cgi_request", "location": "usr/sbin/uhttpd: sym.uh_cgi_request", "risk_score": 9.0, "confidence": 7.75, "description": "Command execution was detected where the system function is used to execute system commands, with part of the command parameters originating from HTTP request data. During CGI request processing, the system function is called to execute commands when specific conditions are met, but the input is not adequately filtered.", "code_snippet": "sym.imp.system(*0xfebc);", "link_identifiers": ["system", "uh_cgi_request", "puVar21", "param_3", "command_injection", "HTTP_parameter"], "notes": "Verify whether the command string stored at address 0xfebc contains user-controllable data"}
{"name": "vulnerability-uhttpd-popen-uh_cgi_request", "location": "usr/sbin/uhttpd: sym.uh_cgi_request", "risk_score": 8.0, "confidence": 7.0, "description": "Command execution is detected using the popen function, with parameters partially sourced from HTTP requests. While processing certain CGI requests, popen is invoked, but insufficient input validation may lead to command injection vulnerabilities.", "code_snippet": "sym.imp.popen(puVar21 + 0xffffffd8);", "link_identifiers": ["popen", "uh_cgi_request", "param_2", "param_3", "command_injection", "HTTP_parameter"], "notes": "Further analysis is needed on the parameter construction process during the popen call."}
{"name": "vulnerability-uhttpd-sprintf-uh_cgi_request", "location": "usr/sbin/uhttpd: sym.uh_cgi_request", "risk_score": 7.5, "confidence": 7.0, "description": "Discovered the use of sprintf for formatting string functions to process HTTP request data, but failed to check the output buffer size. Using sprintf when handling certain HTTP header fields may lead to buffer overflow or format string vulnerabilities.", "code_snippet": "sym.imp.sprintf(iVar17, \"%s\", param_2);", "link_identifiers": ["sprintf", "uh_cgi_request", "acStack_55f8", "param_2", "format_string", "HTTP_header"], "notes": "need to confirm the specific format string content and buffer size"}
{"name": "vulnerability-uhttpd-strncpy-uh_cgi_request", "location": "usr/sbin/uhttpd: sym.uh_cgi_request", "risk_score": 7.0, "confidence": 6.5, "description": "It was discovered that when using strncpy to copy HTTP request data, the length parameter could be user-controlled. While strncpy is used to process certain CGI parameters, the length parameter may originate from unvalidated HTTP header fields.", "code_snippet": "sym.imp.strncpy(puVar21 + 0xffffca2c, iVar17, *(puVar21 + 0xffffaa0c));", "link_identifiers": ["strncpy", "uh_cgi_request", "param_3", "param_4", "buffer_overflow", "HTTP_header"], "notes": "Need to verify the source and validation process of the length parameter *(puVar21 + 0xffffaa0c)"}
{"name": "vulnerability-proccgi-dangerous-functions", "location": "www/cgi-bin/proccgi", "risk_score": 8.0, "confidence": 7.25, "description": "The proccgi binary file processes HTTP requests (GET/POST) as a CGI handler, utilizing hazardous functions (strcpy, atoi) to handle user input (QUERY_STRING, POST data), posing risks of buffer overflow and integer overflow.", "link_identifiers": ["proccgi", "strcpy", "atoi", "QUERY_STRING", "CONTENT_LENGTH", "CGI_POST_TMPFILE", "malloc", "free", "buffer_overflow", "integer_overflow"], "notes": "Dynamic testing or disassembly is required to confirm the specific vulnerability exploitation path. This binary may serve as the primary processor for all form submissions in the web interface."}
{"name": "observation-empty-debug-cgi", "location": "www/debug.cgi", "risk_score": 0.0, "confidence": 5.0, "description": "The target file www/debug.cgi is an empty file that contains no executable code or processing logic. Consequently, there are no HTTP request handlers, dangerous function calls, or potential vulnerabilities available for analysis.", "link_identifiers": ["debug.cgi", "empty_file"], "notes": "It is recommended to check other CGI scripts or web service components, as the debug.cgi file may be a placeholder or an unimplemented interface."}
{"name": "vulnerability-proccgi-command-injection-chain", "file_path": "www/cgi-bin/proccgi", "location": "www/cgi-bin/proccgi & www/cgi-bin/RMT_invite.cgi", "risk_score": 9.0, "confidence": 8.25, "description": "Analysis of multiple findings in proccgi confirms security risks in its handling of HTTP request parameters. proccgi employs unsafe functions (such as strcpy) to process user input and fails to fully filter hazardous characters. When proccgi's output is directly executed by eval in RMT_invite.cgi, attackers can inject arbitrary commands through carefully crafted HTTP parameters, forming a complete command injection vulnerability chain.", "code_snippet": "eval \"`/www/cgi-bin/proccgi $*`\"", "link_identifiers": ["proccgi", "eval", "command_injection", "HTTP_parameter", "RMT_invite.cgi", "QUERY_STRING"], "notes": "The complete vulnerability chain was confirmed by combining multiple findings: HTTP parameters -> proccgi processing -> eval execution"}
