{"name": "network-recv-buffer-overflow-eapd", "location": "bin/eapd:0xb5e4,0xb638,0xb6a4,0xb704,0xb744,0xb7a0", "risk_score": 8.5, "confidence": 8.25, "description": "Multiple unvalidated recv calls detected, receiving network data into fixed-size buffers (0xff0 bytes). These calls are distributed across multiple network event handling branches and lack strict validation of the received data length, potentially leading to buffer overflow. Attackers could trigger overflow by sending excessively long data packets.", "code_snippet": "Not provided in original data", "link_identifiers": ["recv", "0xff0", "fcn.0000b060", "fcn.0000b7fc"], "notes": "Further verification is needed to determine whether the buffer size is sufficient and whether stack protection mechanisms are in place."}
{"name": "unsafe-strcpy-eapd", "location": "bin/eapd:0x8ca0", "risk_score": 7.0, "confidence": 7.25, "description": "It was found that directly using unsafe string manipulation functions such as strcpy may lead to buffer overflow. Particularly when handling wireless interface names (wl%d) and network data, there is a lack of length checks.", "code_snippet": "Not provided in original data", "link_identifiers": ["strcpy", "wl%d", "wl_iovar_set", "wl_ioctl"], "notes": "It is recommended to replace with secure functions such as strncpy and add boundary checks."}
{"name": "wireless-ioctl-unvalidated-eapd", "location": "bin/eapd:0x8d48,0x8ebc", "risk_score": 8.0, "confidence": 7.25, "description": "Multiple wireless interface control operations (wl_iovar_set/wl_ioctl) directly use network-received data as parameters without sufficient validation. Attackers may potentially control the wireless interface by crafting malicious packets.", "code_snippet": "Not provided in original data", "link_identifiers": ["wl_iovar_set", "wl_ioctl", "wl_probe", "wlconf"], "notes": "It is necessary to analyze specific wireless interface control commands and their security implications."}
{"name": "wps-vulnerability-eapd", "location": "bin/eapd:[HIDDEN]", "risk_score": 6.5, "confidence": 6.5, "description": "Detected WPS (Wi-Fi Protected Setup) related processing logic, including monitoring wireless interfaces and event messages. These functionalities may expose sensitive security configuration information.", "code_snippet": "Not provided in original data", "link_identifiers": ["WPS", "wps-monitor", "WFA-SimpleConfig", "wps_mode"], "notes": "Check whether the implementation of WPS functionality has any known vulnerabilities."}
{"name": "nvram-get-unvalidated-eapd", "location": "bin/eapd:0x8e5c", "risk_score": 7.5, "confidence": 7.0, "description": "Interaction with NVRAM (nvram_get) detected, potentially used to retrieve or modify system configurations. Unverified NVRAM operations may lead to configuration tampering.", "code_snippet": "Not provided in original data", "link_identifiers": ["nvram_get", "lan_ifname", "wan_ifnames", "security"], "notes": "Track the source and usage of NVRAM data."}
{"name": "select-cpu-load-eapd", "location": "bin/eapd:0xb348", "risk_score": 5.0, "confidence": 5.5, "description": "The discovery indicates that the select system call is used to monitor multiple file descriptors, but the timeout parameter is set to NULL, which may lead to high CPU load.", "code_snippet": "Not provided in original data", "link_identifiers": ["select", "readfds", "fcn.0000b060"], "notes": "Although it does not directly lead to security issues, it may affect system stability."}
{"name": "missing-wlan-config", "location": "etc/wlan", "risk_score": 3.0, "confidence": 5.0, "description": "No configuration files or wireless network-related settings were found in the etc/wlan directory and its subdirectories. The etc/wlan/default directory is empty, and searches for other common wireless configuration filenames yielded no results. This indicates that wireless network configurations may be stored in non-standard locations or dynamically generated by other mechanisms.", "code_snippet": "Not applicable", "link_identifiers": ["etc/wlan", "etc/wlan/default"], "notes": "It is recommended to check wireless configurations in other directories such as /var or /tmp, or analyze system startup scripts to determine the loading location of wireless configurations."}
{"name": "iptables-reset-vulnerability", "location": "etc/rc.d/iptables-stop", "risk_score": 8.0, "confidence": 7.5, "description": "configuration_load", "code_snippet": "Not provided", "link_identifiers": ["iptables-stop", "iptables -P INPUT ACCEPT", "iptables -P OUTPUT ACCEPT", "iptables -P FORWARD ACCEPT"], "notes": "This could be particularly dangerous if combined with other vulnerabilities that allow script execution."}
{"name": "vulnerable-kernel-modules", "location": "etc/rc.d/rc.modules", "risk_score": 7.0, "confidence": 7.5, "description": "The `rc.modules` script loads numerous kernel modules, including network and netfilter modules. Some modules like `xt_string.ko` and `ipt_multiurl.ko` may have known vulnerabilities in their specific versions.", "code_snippet": "Not provided", "link_identifiers": ["rc.modules", "insmod", "xt_string.ko", "ipt_multiurl.ko", "xt_comment.ko"], "notes": "configuration_load"}
{"name": "insecure-boot-script", "location": "etc/rc.d/rcS", "risk_score": 9.0, "confidence": 8.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided", "link_identifiers": ["rcS", "mount -t ramfs", "tdbrun /usr/bin/httpd", "/usr/bin/ledserver", "REDACTED_SENSITIVE_DATA"], "notes": "configuration_load"}
{"name": "outdated-kernel", "location": "etc/rc.d/rc.modules", "risk_score": 9.5, "confidence": 10.0, "description": "configuration_load", "code_snippet": "Not provided", "link_identifiers": ["2.6.36", "lib/modules/2.6.36"], "notes": "Kernel 2.6.36 is extremely outdated and should be considered inherently vulnerable."}
{"name": "boot-race-condition", "location": "etc/rc.d/rcS", "risk_score": 7.5, "confidence": 6.5, "description": "The startup sequence creates potential race conditions where services start before all security measures are in place (e.g., httpd starting before firewall rules are fully configured).", "code_snippet": "Not provided", "link_identifiers": ["tdbrun /usr/bin/httpd", "/etc/rc.d/rc.modules", "iptables-stop"], "notes": "configuration_load"}
{"name": "REDACTED_SENSITIVE_DATA", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 0.0, "confidence": 5.0, "description": "configuration_load", "code_snippet": "Not accessible", "link_identifiers": ["REDACTED_SENSITIVE_DATA", "REDACTED_SENSITIVE_DATA"], "notes": "configuration_load"}
{"name": "REDACTED_SENSITIVE_DATA", "location": "etc/shadow:1", "risk_score": 8.5, "confidence": 8.0, "description": "configuration_load", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["REDACTED_PASSWORD_PLACEHOLDER", "$1$", "GTN.gpri", "REDACTED_SENSITIVE_DATA", "etc/shadow"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "missing-ssh-config", "location": "etc/", "risk_score": 2.0, "confidence": 5.5, "description": "No `sshd_config` or other SSH-related configuration files were found in the `etc` directory or its subdirectories. This suggests that the target firmware may not have the SSH service enabled, or the SSH configuration files are located in a non-standard path.", "code_snippet": "Not applicable", "link_identifiers": ["sshd_config", "ssh", "etc"], "notes": "It is recommended to check other directories of the firmware, such as `usr/sbin` or `usr/bin`, for SSH-related executable files to confirm the presence of SSH services. If no SSH service is found, other network services may need to be considered as potential attack surfaces."}
{"name": "led-service-command-injection", "location": "fcn.00008ac4", "risk_score": 8.2, "confidence": 8.15, "description": "The LED control service receives external commands via a Unix domain socket (/var/run/ledevent), posing a risk of unauthenticated command injection. Attackers can send crafted commands to manipulate GPIO devices (/dev/gpio), enabling unauthorized LED operations or system interference.", "code_snippet": "Not provided", "link_identifiers": ["/var/run/ledevent", "execute_led_cmd", "gpio_open", "gpios_ioctl", "led_on", "led_off"], "notes": "Verify whether the socket permission settings are restricted to privileged users."}
{"name": "led-state-machine-bypass", "location": "0x00008b50-0x00008b60", "risk_score": 7.3, "confidence": 7.5, "description": "Multiple branch jumps based on unverified user input (at 0x8b50/0x8b58) were found in the command processing logic (fcn.00008ac4), which may lead to illegal state transitions. Attackers could craft special parameters to bypass the normal state machine flow.", "code_snippet": "Not provided", "link_identifiers": ["cmp r3, 1", "cmp r3, 2", "beq 0x8ba4", "beq 0x8be4"], "notes": "The state transition logic needs to be further analyzed in conjunction with the GPIO operation context."}
{"name": "gpio-boundary-check-missing", "location": "0x00008d60-0x00008d68", "risk_score": 7.8, "confidence": 6.85, "description": "The GPIO device operation functions (fcn.00008a34/fcn.00008a7c) directly perform bitwise operations using user-supplied parameters (LSL instruction at 0x00008d64), lacking boundary checks which may lead to out-of-bounds access.", "code_snippet": "Not provided", "link_identifiers": ["lsl r3, r2, r3", "fcn.00008a34", "fcn.00008a7c", "gpios_ioctl"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "led-service-dos", "location": "fcn.000087e0", "risk_score": 5.8, "confidence": 6.35, "description": "When the service thread creation fails, only the error message (around 0x000087e0) is logged without taking appropriate recovery measures, which may lead to denial of service.", "code_snippet": "Not provided", "link_identifiers": ["failed to create led server thread", "pthread_create", "ledProcess"], "notes": "Assess the actual impact in conjunction with the system logging mechanism"}
{"name": "unix-socket-file-handling", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 6.5, "confidence": 7.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided", "link_identifiers": ["/var/run/ledevent", "unlink", "bind socket error"], "notes": "Check the permission settings of this file in the system startup script."}
{"name": "hotplug-command-injection", "location": "sbin/hotplug", "risk_score": 8.5, "confidence": 8.25, "description": "command_execution", "code_snippet": "Not provided", "link_identifiers": ["system", "execve", "hotplug", "_eval"], "notes": "The specific context of command execution needs to be analyzed."}
{"name": "hotplug-nvram-manipulation", "location": "sbin/hotplug", "risk_score": 8.0, "confidence": 7.75, "description": "The program includes NVRAM operation functions (nvram_get/nvram_set), which may allow attackers to modify system configurations. There is a lack of strict input validation.", "code_snippet": "Not provided", "link_identifiers": ["nvram_get", "nvram_set"], "notes": "track the data flow of NVRAM operations"}
{"name": "hotplug-network-config", "location": "sbin/hotplug", "risk_score": 7.5, "confidence": 7.25, "description": "The program handles network configuration (VLAN/vconfig) and may be exploited to modify network settings, enabling man-in-the-middle attacks, among other threats.", "code_snippet": "Not provided", "link_identifiers": ["vconfig", "wl_ioctl"], "notes": "Verify the permission controls for network configuration modifications"}
{"name": "insecure-service-startup", "location": "etc/rc.d/rcS:33", "risk_score": 8.0, "confidence": 7.75, "description": "The script initiates critical services `httpd` and `ledserver` without performing any security checks or environment validation. Attackers could achieve persistence by tampering with these service binaries or configuration files.", "code_snippet": "tdbrun /usr/bin/httpd &", "link_identifiers": ["tdbrun", "httpd", "ledserver"], "notes": "Further analysis is required on the interaction between the `tdbrun` binary and `httpd`"}
{"name": "ramfs-security-issues", "location": "etc/rc.d/rcS:8-9,21", "risk_score": 7.5, "confidence": 7.75, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["mount", "ramfs", "REDACTED_SENSITIVE_DATA"], "notes": "The ramfs configuration may impact system security; it is necessary to check other components' dependencies on /tmp."}
{"name": "kernel-parameter-modification", "location": "etc/rc.d/rcS:25,35", "risk_score": 6.5, "confidence": 6.5, "description": "Directly manipulating operating system kernel parameters (such as drop_caches, ipfrag_high_thresh) without verifying the current system state. Malicious modification of these parameters may cause denial of service or performance degradation.", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["/proc/sys/vm/drop_caches", "REDACTED_SENSITIVE_DATA"], "notes": "Verify whether these parameter modifications are necessary and assess their security impact."}
{"name": "commented-kernel-modules", "location": "etc/rc.d/rcS:13-14,30-31", "risk_score": 6.0, "confidence": 5.5, "description": "The commented-out code indicates that the system may load vulnerable kernel modules (such as usb-storage.ko). Although currently commented out, the retained code suggests these modules could potentially be enabled under specific conditions.", "code_snippet": "#insmod /lib/modules/2.6.36/nas/usb-storage.ko", "link_identifiers": ["usb-storage.ko", "ag7100_mod.ko", "ag7240_mod.ko"], "notes": "Check whether these kernel modules have any known vulnerabilities."}
{"name": "unverified-module-loading", "location": "etc/rc.d/rcS:19", "risk_score": 7.0, "confidence": 7.0, "description": "The system loads additional kernel modules via `/etc/rc.d/rc.modules`, but fails to perform integrity verification on this script. Attackers could potentially achieve kernel-level code execution by tampering with this script.", "code_snippet": "/etc/rc.d/rc.modules", "link_identifiers": ["rc.modules"], "notes": "Further analysis of the rc.modules script content is required."}
{"name": "tdbrun-command-injection", "location": "usr/bin/tdbrun:8,10,12", "risk_score": 8.5, "confidence": 8.25, "description": "The script directly passes unvalidated user input parameters ($*) to the tdb command execution, posing a command injection risk. Attackers can inject malicious commands by controlling the parameters, especially when $1 is empty, as the script will directly execute subsequent parameters.", "code_snippet": "/usr/bin/tdb -r $* &\n/tmp/tdb -r $* &\n$* &", "link_identifiers": ["$*", "tdb -r", "$* &"], "notes": "It is necessary to verify whether the tdb command properly filters input parameters. If the tdb command itself contains vulnerabilities, this wrapper script would amplify the risks."}
{"name": "tdbrun-tmp-file-execution", "location": "usr/bin/tdbrun:10-11", "risk_score": 7.0, "confidence": 7.0, "description": "The script directly executes the /tmp/tdb file after checking its existence and attempts to modify its permissions (chmod +x). If an attacker can create a malicious tdb file in the /tmp directory, it may lead to arbitrary code execution.", "code_snippet": "elif [ -f /tmp/tdb ]; then\n\tchmod +x /tmp/tdb &>/dev/null || true\n\t/tmp/tdb -r $* &", "link_identifiers": ["/tmp/tdb", "chmod +x"], "notes": "Check if the system restricts file creation permissions in the /tmp directory."}
{"name": "tdbrun-direct-command-execution", "location": "usr/bin/tdbrun:14", "risk_score": 9.5, "confidence": 8.75, "description": "When tdb does not exist, the script directly executes the user-provided parameters ($*), which is an extremely dangerous behavior that allows arbitrary command execution.", "code_snippet": "echo \"WARN: TDB not supported!\"\n\t$* &", "link_identifiers": ["$* &"], "notes": "This is the most critical vulnerability and requires immediate remediation. The fallback execution logic should be completely removed."}
{"name": "tdbrun-arbitrary-command-execution", "location": "usr/bin/tdbrun:12", "risk_score": 9.5, "confidence": 8.5, "description": "When neither `/usr/bin/tdb` nor `/tmp/tdb` exists, the script will directly execute any command provided by the user (`$* &`). An attacker can control the input parameters to execute arbitrary commands.", "code_snippet": "$* &", "link_identifiers": ["tdbrun", "tdb -r", "$*"], "notes": "It is necessary to verify the existence and permission settings of `/usr/bin/tdb` and `/tmp/tdb`. If neither of these files exists or has been deleted, attackers can easily exploit this vulnerability."}
{"name": "tdbrun-tmp-path-hijacking", "location": "usr/bin/tdbrun:8-9", "risk_score": 8.0, "confidence": 7.75, "description": "The script loads executable files (`/tmp/tdb`) from the `/tmp` directory, posing a potential path hijacking risk. Attackers can place malicious files in the `/tmp` directory to exploit the script's automatic execution.", "code_snippet": "elif [ -f /tmp/tdb ]; then\n\tchmod +x /tmp/tdb &>/dev/null || true\n\t/tmp/tdb -r $* &", "link_identifiers": ["/tmp/tdb", "chmod +x /tmp/tdb"], "notes": "It is necessary to check whether the system has set appropriate permissions for the `/tmp` directory and whether there are other protective measures in place to prevent files in the `/tmp` directory from being maliciously exploited."}
{"name": "tdbrun-command-injection", "location": "usr/bin/tdbrun: multiple locations", "risk_score": 8.5, "confidence": 8.75, "description": "The script does not perform any validation or filtering on input parameters and directly passes all parameters (`$*`) to the underlying command execution. This may lead to command injection vulnerabilities.", "code_snippet": "/usr/bin/tdb -r $* &\n/tmp/tdb -r $* &\n$* &", "link_identifiers": ["$*", "tdb -r $*"], "notes": "It is recommended to strictly validate input parameters and use quotes to wrap variables (e.g., \"$@\") to prevent command injection."}
