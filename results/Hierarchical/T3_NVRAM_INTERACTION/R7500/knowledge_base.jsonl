{"name": "nvram-analysis-readycloud_nvram-negative", "file_path": "bin/readycloud_nvram", "location": "./bin/readycloud_nvram", "risk_score": 0.0, "confidence": 4.0, "description": "Analysis of './bin/readycloud_nvram' (which actually points to 'config' file) revealed no direct NVRAM or environment variable (getenv) access operations. This binary implements configuration management functionality through the libconfig.so library, utilizing custom functions (config_get/config_set etc.) rather than standard environment variable operations.", "link_identifiers": ["config_get", "config_set", "libconfig.so"], "notes": "Analyze the libconfig.so library to confirm the presence of NVRAM operations."}
{"name": "envvar-analysis-readycloud_nvram-negative", "file_path": "bin/readycloud_nvram", "location": "./bin/readycloud_nvram", "risk_score": 0.0, "confidence": 4.0, "description": "No environment variable (getenv) operations detected; configuration management is implemented via custom functions rather than standard environment variables.", "link_identifiers": ["config_get", "config_set", "strcpy", "sprintf"], "notes": "configuration_load"}
{"name": "external-config-NVRAM-config_set", "file_path": "bin/nvram", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 0.0, "confidence": 4.5, "description": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["config_get", "config_set", "config_unset", "config_commit", "sym.imp.config_set"], "notes": "Suggested directions for further analysis: 1. Search for library files in the system that may contain implementations of `config_set` and `config_get`; 2. Analyze the code paths that call these functions to indirectly evaluate their security."}
{"name": "nvram-analysis-libconfig", "file_path": "bin/nvram", "location": "./bin/readycloud_nvram", "risk_score": 0.0, "confidence": 4.0, "description": "Analysis of './bin/readycloud_nvram' (which actually points to 'config' file) revealed no direct NVRAM or environment variable (getenv) access operations. This binary implements configuration management functions through the libconfig.so library, utilizing custom functions (config_get/config_set etc.) rather than standard environment variable operations. Further analysis of the libconfig.so library is required to confirm the presence of NVRAM operations.", "link_identifiers": ["config_get", "config_set", "libconfig.so"], "notes": "Analyze the libconfig.so library to confirm the presence of NVRAM operations."}
{"name": "config-management-bin-config", "file_path": "bin/config", "location": "bin/config (imported functions)", "risk_score": 2.0, "confidence": 5.0, "description": "Analysis of the './bin/config' file reveals that this program is a configuration management tool, primarily managing configurations by calling functions from libconfig.so (such as config_get, config_set, etc.). No direct usage of getenv or NVRAM-related operations was found in the current file. These configuration operations may indirectly involve environment variable access, but further analysis of libconfig.so is required to confirm.", "code_snippet": "", "link_identifiers": ["config_get", "config_set", "config_unset", "config_commit", "libconfig.so"], "notes": "It is recommended to analyze the libconfig.so library file to verify the presence of environment variables or NVRAM operations. No obvious security risks were identified in the current file."}
{"name": "script-sysctl-no-env-access", "file_path": "etc/init.d/sysctl", "location": "sysctl:7", "risk_score": 0.0, "confidence": 4.75, "description": "The './etc/init.d/sysctl' script does not contain any direct access to environment variables (NVRAM or similar). The only variable used is a loop variable `$i` for processing configuration files. No security risks related to environment variable handling were identified in this script.", "code_snippet": "for i in /etc/sysctl.d/*.conf; do\n\tsysctl -p $i >&-\ndone", "link_identifiers": ["$i"], "notes": "configuration_load"}
{"name": "envvar-datalib-config", "file_path": "etc/init.d/datalib", "location": "./etc/init.d/datalib", "risk_score": 5.0, "confidence": 6.5, "description": "The datalib initialization script was found to utilize multiple environment variables for generating network configurations. Although the script does not directly call getenv or nvram commands, the usage of these variables suggests they may originate from system environment or NVRAM settings. The variables include product names and multiple network interface configurations. These configurations are written directly to configuration files, which could lead to configuration tampering if the variables are maliciously controlled.", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["DGC_PRODUCT_NAME", "DGC_LAN_ETH_IF", "DGC_WLAN_IF", "DGC_WAN_BR_IF", "DGC_LAN_BR_IF", "CONF_FILE", "part_path"], "notes": "Although the use of environment variables was identified, there is no direct evidence indicating these variables originate from NVRAM. It is recommended to further analyze the source of these variables and how they are set. Additionally, the script employs command substitution ($(...)) to retrieve partition paths and process IDs, which may require additional security checks."}
{"name": "nvram-dsl_wan_preference", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:1", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "dsl_wan_preference"]}
{"name": "nvram-wan_proto", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:2", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_proto"]}
{"name": "nvram-qos_endis_on", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:3", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "qos_endis_on"]}
{"name": "nvram-wan_${typesign}_mac_assign", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:6", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_${typesign}_mac_assign"]}
{"name": "nvram-dsl_wan_country", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:9", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "dsl_wan_country"]}
{"name": "nvram-dsl_wan_isp", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:9", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "dsl_wan_isp"]}
{"name": "nvram-wan_ether_this_mac", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:10", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get  \n\nUsed for MAC address configuration, may affect network security, medium risk", "link_identifiers": ["$CONFIG get", "wan_ether_this_mac"]}
{"name": "nvram-wan_dhcp_mtu", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:16", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_dhcp_mtu"]}
{"name": "nvram-ipv6_type", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:17", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "ipv6_type"]}
{"name": "nvram-endis_ipv6_logo_test", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:17", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "endis_ipv6_logo_test"]}
{"name": "nvram-wan_ipaddr", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:19", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_ipaddr"]}
{"name": "nvram-wan_netmask", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:19", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_netmask"]}
{"name": "nvram-wan_gateway", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:20", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_gateway"]}
{"name": "nvram-qos_threshold", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:24", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "qos_threshold"]}
{"name": "nvram-qos_bandwidth_type", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:24", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "qos_bandwidth_type"]}
{"name": "nvram-wan_hostname", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:28", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_hostname"]}
{"name": "nvram-Device_name", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:28", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "Device_name"]}
{"name": "nvram-wan_domain", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:29", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_domain"]}
{"name": "nvram-wan_dhcp_ipaddr", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:33", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_dhcp_ipaddr"]}
{"name": "nvram-wan_dhcp_oldip", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:33", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_dhcp_oldip"]}
{"name": "nvram-wan_ether_dns1", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:36", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_ether_dns1"]}
{"name": "nvram-wan_ether_dns2", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:37", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_ether_dns2"]}
{"name": "nvram-wan_ether_dns3", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:38", "risk_score": 8.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_ether_dns3"]}
{"name": "nvram-trafficmeter_monthly_limit_reached", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:42", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "trafficmeter_monthly_limit_reached"]}
{"name": "nvram-traffic_block_all", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:42", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "traffic_block_all"]}
{"name": "nvram-GUI_Region", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:43", "risk_score": 2.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "GUI_Region"]}
{"name": "nvram-wan_pppoe_intranet_wan_assign", "file_path": "etc/init.d/net-wan", "location": "./etc/init.d/net-wan:48", "risk_score": 5.0, "confidence": 4.0, "description": "nvram_get", "link_identifiers": ["$CONFIG get", "wan_pppoe_intranet_wan_assign"]}
