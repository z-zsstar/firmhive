{"name": "command-injection-http-param-b268", "file_path": "sbin/acos_service", "location": "acos_service:0xb268 main", "risk_score": 9.0, "confidence": 8.25, "description": "High-risk command injection vulnerability. Attackers can inject malicious commands by controlling the param_2[1] parameter. When this parameter matches a specific string (*0xc2cc), the program constructs and executes a system command via sprintf. Verification is required to determine whether the param_2 parameter originates from GET/POST parameters in HTTP requests.", "code_snippet": "iVar14 = sym.imp.strcmp(iVar6,*0xc2cc);\nif (iVar14 == 0) {\n    sym.imp.sprintf(puVar19 + -0x18c,*0xc3c0,*0xc3bc);\n    sym.imp.system(puVar19 + -0x18c);", "link_identifiers": ["param_2", "strcmp", "sprintf", "system", "*0xc2cc", "puVar19 + -0x18c", "http_param"], "notes": "Verify whether the param_2 parameter originates from the GET/POST parameters of the HTTP request."}
{"name": "buffer-overflow-nvram-config", "file_path": "sbin/acos_service", "location": "fcn.0000a600:0xa878, fcn.0000d35c:0xd3e0, main:0xb5a4", "risk_score": 8.5, "confidence": 8.25, "description": "Multiple buffer overflow risks. The return value of 'acosNvramConfig_get' is directly passed to 'strcpy' without length checking, potentially causing stack overflow. These configuration parameters may originate from the web interface, requiring input source validation.", "code_snippet": "uVar4 = sym.imp.acosNvramConfig_get(*0xaf0c);\nsym.imp.strcpy(puVar9,uVar4);", "link_identifiers": ["strcpy", "acosNvramConfig_get", "fcn.0000a600", "fcn.0000d35c", "main", "web_config"], "notes": "These configuration parameters may originate from the web interface, requiring validation of the input source."}
{"name": "mac-command-injection-b3fc", "file_path": "sbin/acos_service", "location": "acos_service:0xb3fc main", "risk_score": 7.5, "confidence": 7.0, "description": "Network configuration command injection vulnerability. The program reads the Ethernet MAC address and directly concatenates it into a command string for execution without validation, which could be exploited by forged MAC addresses. The MAC address may originate from either the network interface or web configuration.", "code_snippet": "sym.imp.bd_read_eth_mac(puVar19 + -0xc,puVar17);\nsym.imp.sprintf(iVar6,*0xc364,uVar4,uVar5);\nsym.imp.system(iVar6);", "link_identifiers": ["bd_read_eth_mac", "sprintf", "system", "puVar19 + -0xc", "*0xc364", "mac_config"], "notes": "MAC addresses may originate from network interfaces or web configurations"}
{"name": "hardcoded-system-calls", "file_path": "sbin/acos_service", "location": "acos_service:HIDDEN", "risk_score": 6.0, "confidence": 6.5, "description": "Multiple hardcoded system command execution points, although not directly affected by external input, increase the attack surface. The program extensively uses system calls to execute configuration commands. It is recommended to review all hardcoded system calls.", "link_identifiers": ["system", "*0xc214", "*0xc254", "*0xc258", "*0xc25c", "command_execution"], "notes": "Review all hardcoded system calls"}
{"name": "network_input-htmlget-sprintf_overflow", "file_path": "sbin/htmlget", "location": "htmlget: fcn.000087f0 (0x8924)", "risk_score": 7.5, "confidence": 7.0, "description": "An unsafe 'sprintf' call (address 0x8924) was detected in function 'fcn.000087f0' of file 'sbin/htmlget', used for formatting HTTP request strings. The target buffer is allocated via 'malloc(0x46)', but there is no explicit length check during string formatting. The format string contains two variable parameters (hostname and user agent), which may cause buffer overflow if these inputs are excessively long.\n\nSecurity Impact:\n- May lead to buffer overflow, with risk depending on whether the hostname or user agent strings can be controlled by an attacker.\n- Although it does not directly process HTTP parameters, it involves HTTP request formatting and is part of a web service component.\n\nRecommendations:\n- Replace with 'snprintf' and provide buffer size limitation.\n- Verify that the length of hostname and user agent strings does not exceed buffer limits.", "code_snippet": "sprintf(buffer, \"GET / HTTP/1.0\\r\\nHost: %s\\r\\nUser-Agent: %s\\r\\n\\r\\n\", hostname, user_agent);", "link_identifiers": ["fcn.000087f0", "sprintf", "0x8924", "GET / HTTP/1.0\\r\\nHost: %s\\r\\nUser-Agent: %s\\r\\n\\r\\n", "www.netgear.com", "HTMLGET 1.0", "HTTP response parsing", "network_input"], "notes": "Further verification is needed to determine whether the hostname and user-agent string can be controlled by an attacker. The buffer size (0x46 bytes) appears sufficient for default values, but may be inadequate if longer strings are used."}
{"name": "command-injection-http-param-b268", "file_path": "sbin/htmlget", "location": "acos_service:0xb268 main", "risk_score": 9.0, "confidence": 8.25, "description": "High-risk command injection vulnerability. An attacker can inject malicious commands by controlling the param_2[1] parameter. When this parameter matches a specific string (*0xc2cc), the program constructs and executes system commands via sprintf. It is necessary to verify whether the param_2 parameter originates from GET/POST parameters in HTTP requests.", "code_snippet": "iVar14 = sym.imp.strcmp(iVar6,*0xc2cc);\nif (iVar14 == 0) {\n    sym.imp.sprintf(puVar19 + -0x18c,*0xc3c0,*0xc3bc);\n    sym.imp.system(puVar19 + -0x18c);", "link_identifiers": ["param_2", "strcmp", "sprintf", "system", "*0xc2cc", "puVar19 + -0x18c", "http_param", "command_execution"], "notes": "Verify whether the param_2 parameter originates from the GET/POST parameters of the HTTP request."}
