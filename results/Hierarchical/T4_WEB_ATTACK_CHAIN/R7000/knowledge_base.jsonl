{"name": "web-genie.cgi-QUERY_STRING-handling", "file_path": "www/cgi-bin/genie.cgi", "location": "genie.cgi", "risk_score": 2.0, "confidence": 5.0, "description": "Analysis of genie.cgi did not reveal any instances where HTTP parameters were directly passed to dangerous functions. The QUERY_STRING environment variable, after being retrieved, is primarily used for URL construction and logging purposes. The functions employed—such as getenv, snprintf, and strncpy—are relatively secure. No evident command injection or buffer overflow vulnerabilities were identified.", "link_identifiers": ["QUERY_STRING", "getenv", "snprintf", "strncpy"], "notes": "Although no direct security issues were identified, it is still recommended to implement strict input validation for parameters obtained from environment variables to prevent potential injection attacks."}
{"name": "client-js-opmode.js", "file_path": "www/cgi-bin/opmode.js", "location": "www/cgi-bin/opmode.js", "risk_score": 0.0, "confidence": 4.5, "description": "Analysis of file 'www/cgi-bin/opmode.js' found no instances where HTTP parameters are directly passed to dangerous functions. The file primarily contains client-side JavaScript functions for form validation, network configuration, and security settings, with no server-side interactions that could lead to command injection or buffer overflow vulnerabilities.", "code_snippet": "", "link_identifiers": ["checkipaddr", "maccheck", "checkwep", "checkpsk", "PassPhrase40", "PassPhrase104", "calcMD5"], "notes": "The file focuses on client-side operations and does not directly handle HTTP request processing. Further analysis of server-side CGI scripts or binaries may be required to identify potential vulnerabilities."}
{"name": "js-redirect-logic-changeUrl.js", "file_path": "www/cgi-bin/changeUrl.js", "location": "www/cgi-bin/changeUrl.js", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/cgi-bin/changeUrl.js' is a JavaScript file primarily used for page redirection logic. Analysis reveals that this file does not contain any instances where HTTP input is passed to dangerous functions such as `eval`, the `Function` constructor, `setTimeout`, or `setInterval`. The function `change_url` accepts a parameter `file_name`, but it is solely used to construct a redirection URL and is not directly passed to any dangerous functions.", "link_identifiers": ["check_top_url", "change_url", "file_name", "top.location.href"], "notes": "Although no direct security vulnerabilities were found, it is recommended to further verify the source of the `file_name` parameter to ensure it has not been maliciously constructed."}
{"name": "js-frontend-www-cgi-bin-script.js", "file_path": "www/cgi-bin/script.js", "location": "www/cgi-bin/script.js", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/cgi-bin/script.js' primarily contains front-end JavaScript code used for handling UI interactions and DOM operations. No code for processing HTTP requests was found in the file, nor were there instances of passing external input to dangerous functions (such as `system`, `strcpy`, `sprintf`, etc.).", "code_snippet": "", "link_identifiers": ["buttonFilter", "buttonClick", "clickButton", "REDACTED_SECRET_KEY_PLACEHOLDER", "REDACTED_SECRET_KEY_PLACEHOLDER", "iframeResize", "grayout_button", "ungrayout_button", "highLightMenu", "change_size", "get_browser", "get_ie_ver", "REDACTED_SECRET_KEY_PLACEHOLDER", "setFooterClass", "subpage_resize", "do_search", "detectEnter", "detectOS", "goto_wireless", "goto_internet"], "notes": "This file does not involve backend HTTP request processing or dangerous function calls. It is recommended to analyze other CGI scripts or binary files to identify potential security vulnerabilities."}
{"name": "client-js-IA_AP_settings", "file_path": "www/IA_AP_settings.js", "location": "www/IA_AP_settings.js", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/IA_AP_settings.js' is a client-side JavaScript file primarily used for handling the front-end interface logic of wireless network settings. It does not contain code that directly processes HTTP requests or invokes dangerous functions, thus no evidence was found of passing external HTTP input to dangerous functions.", "code_snippet": "", "link_identifiers": ["loadSettings", "show_24g_div", "show_5g_div", "CheckData", "CheckData24G", "CheckData5G"], "notes": "It is recommended to continue analyzing other files that may handle HTTP requests, such as CGI scripts or server-side JavaScript files."}
{"name": "web-redirect-indexhtm", "file_path": "www/index.htm", "location": "www/index.htm", "risk_score": 4.0, "confidence": 6.5, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "N/A (HTML/JavaScript code not provided)", "link_identifiers": ["welcome.htm", "start.htm", "traffic_start_update.htm", "routerlogin.com"], "notes": "It is recommended to further analyze pages such as 'welcome.htm', 'start.htm', and 'traffic_start_update.htm' to search for clues related to web service components."}
{"name": "web-ap_settings-analysis", "file_path": "www/ap_settings.js", "location": "www/ap_settings.js", "risk_score": 2.0, "confidence": 5.0, "description": "After analyzing the 'www/ap_settings.js' file, no direct HTTP request handling logic or code that directly passes external input to dangerous functions was found. The file primarily handles wireless network settings, including region selection, channel configuration, and security mode setup. No obvious XSS vulnerability patterns were identified.", "code_snippet": "", "link_identifiers": ["CheckData", "CheckData24G", "CheckData5G", "change_sec", "setChannel", "setOpMode"], "notes": "configuration_load"}
{"name": "frontend-validation-www-func.js", "file_path": "www/func.js", "location": "www/func.js", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/func.js' primarily contains frontend input validation and window management functions (such as openHelpWin, openGlossWin, etc.), with no direct HTTP request handling functions or obvious dangerous operations (e.g., `system`, `strcpy`, `sprintf`, etc.) found. It is recommended to further analyze other files (such as CGI scripts or binary files) to identify HTTP request handling functions and potential dangerous operations.", "code_snippet": "HIDDEN", "link_identifiers": ["openHelpWin", "openGlossWin", "openDataSubWin", "checkValid", "checkInt", "checkBlank", "MACAddressBlur", "isIPv6Equals"], "notes": "Further analysis of other files (such as CGI scripts or binary files) is recommended to identify functions handling HTTP requests and potential hazardous operations."}
{"name": "web-browser.js-input_processing", "file_path": "www/browser.js", "location": "browser.js", "risk_score": 0.0, "confidence": 4.5, "description": "Analysis of the 'www/browser.js' file did not reveal any code that directly passes HTTP parameters to dangerous front-end operations. The file contains two main functions, 'add' and 'load4', which are solely used for concatenating and splitting input values, with no involvement in hazardous operations such as unsafe usage of 'eval' or 'innerHTML'.", "code_snippet": "function add(out,in1,in2,in3,in4) {\n    var Total;\n    Total=in1.value+\".\"+in2.value+\".\"+in3.value+\".\"+in4.value;\n    out.value=Total; \n}", "link_identifiers": ["add", "load4", "Mydata", "in1", "in2", "in3", "in4", "ip1", "ip2", "ip3", "ip4"], "notes": "No direct security risks were detected. It is recommended to further inspect other files to confirm the presence of any potential vulnerabilities."}
{"name": "frontend-utilityjs-no_http_processing", "file_path": "www/utility.js", "location": "www/utility.js", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/utility.js' primarily contains frontend JavaScript functionalities such as marquee effects and form validation functions. Analysis results indicate that this file does not include code for handling HTTP requests nor does it pass external inputs to hazardous functions. Therefore, this file does not contain security vulnerabilities related to user requests.", "code_snippet": "N/A (HIDDENJavaScriptHIDDEN)", "link_identifiers": ["Marquee_init", "Marquee_set_timeInterval", "Marquee_set_event", "need_to_run_marquee", "isIPaddr", "isValidIPaddr", "checkMacStr", "checkIP", "isNumeric"], "notes": "The primary functionality of this file is frontend display and form validation, with no involvement in backend HTTP request processing. It is recommended to proceed with analyzing other files that may handle HTTP requests, such as CGI scripts or binary files."}
{"name": "js-string_addstr", "file_path": "www/msg.js", "location": "www/msg.js", "risk_score": 1.0, "confidence": 5.0, "description": "The file 'www/msg.js' contains a string concatenation function 'addstr' which utilizes JavaScript string manipulation methods (such as `indexOf`, `substring`) for concatenation. No direct calls to dangerous functions (e.g., `system`, `strcpy`, `sprintf`) were detected. The function logic is secure, but it is recommended to examine the context in which this function is called to ensure inputs are properly validated and escaped.", "code_snippet": "function addstr(input_msg)\n{\n\tvar last_msg = \"\";\n\tvar str_location;\n\tvar temp_str_1 = \"\";\n\tvar temp_str_2 = \"\";\n\tvar str_num = 0;\n\ttemp_str_1 = addstr.arguments[0];\n\twhile(1)\n\t{\n\t\tstr_location = temp_str_1.indexOf(\"%s\");\n\t\tif(str_location >= 0)\n\t\t{\n\t\t\tstr_num++;\n\t\t\ttemp_str_2 = temp_str_1.substring(0,str_location);\n\t\t\tlast_msg += temp_str_2 + addstr.arguments[str_num];\n\t\t\ttemp_str_1 = temp_str_1.substring(str_location+2,temp_str_1.length);\n\t\t\tcontinue;\n\t\t}\n\t\tif(str_location < 0)\n\t\t{\n\t\t\tlast_msg += temp_str_1;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn last_msg;\n}", "link_identifiers": ["addstr", "indexOf", "substring", "arguments"], "notes": "Although no direct security vulnerabilities were found, the 'addstr' function may be used to handle dynamically generated strings. It is recommended to further examine the context in which this function is called to ensure that inputs are properly validated and escaped."}
{"name": "js-form-RU_welcome", "file_path": "www/RU_welcome.js", "location": "RU_welcome.js:1", "risk_score": 0.0, "confidence": 4.5, "description": "The 'RU_manual_check_summary' function in the file 'www/RU_welcome.js' primarily handles the submission of network configuration forms, retrieving parameters from the parent window and populating the form. No direct handling of HTTP requests or use of dangerous functions was found. The form submission employs standard JavaScript form submission methods (cf.submit()), with no unsafe data processing approaches.", "code_snippet": "function RU_manual_check_summary()\n{\n\tvar cf=document.forms[0];\n\tif(parent.welcome_wan_type == 1)\n\t{\n\t\tcf.ether_ipaddr.value=parent.static_ip;\n\t\tcf.ether_subnet.value=parent.static_subnet;\n\t\tcf.ether_gateway.value=parent.static_gateway;\n\t\tcf.ether_dnsaddr1.value=parent.static_dns1;\n\t\tcf.ether_dnsaddr2.value=parent.static_dns2;\n\t\tcf.DNSAssign.value=\"1\";\n\t\tcf.system_name.value=parent.account_name;\n\t\tcf.domain_name.value=\"\";\n\t\tcf.WANAssign.value=\"static\";", "link_identifiers": ["RU_manual_check_summary", "document.forms[0]", "parent.welcome_wan_type", "parent.static_ip", "parent.static_subnet", "parent.static_gateway", "parent.static_dns1", "parent.static_dns2", "parent.account_name", "parent.mac_spoof", "parent.pppoe_REDACTED_PASSWORD_PLACEHOLDER", "parent.pppoe_password", "parent.pppoe_server", "parent.pppoe_static_ip", "parent.dual_access", "parent.pppoe_eth_ip", "parent.pppoe_eth_netmask", "parent.pppoe_eth_gateway", "parent.pppoe_dual_assign", "parent.pppoe_dns1", "parent.pppoe_dns2", "parent.pppoe_wan_assign", "parent.pptp_REDACTED_PASSWORD_PLACEHOLDER", "parent.pptp_password", "parent.pptp_local_ipaddr", "parent.pptp_local_netmask", "parent.pptp_server_ipaddr", "parent.pptp_local_gateway", "parent.pptp_connect_id", "parent.pptp_dns1", "parent.pptp_dns2", "parent.pptp_wan_assign", "parent.STATIC_DNS", "parent.l2tp_REDACTED_PASSWORD_PLACEHOLDER", "parent.REDACTED_PASSWORD_PLACEHOLDER", "parent.l2tp_local_ipaddr", "parent.l2tp_local_netmask", "parent.l2tp_server_ipaddr", "parent.l2tp_local_gateway", "parent.l2tp_dns1", "parent.l2tp_dns2", "parent.l2tp_wan_assign", "parent.Spoofmac", "parent.conflict_wanlan", "cf.submit()"], "notes": "The file appears to be a front-end JavaScript file primarily used for form handling and submission. No direct handling of HTTP requests or use of dangerous functions was detected. It is recommended to further analyze the source of the parent window (parent object) to determine whether these parameters originate from user input."}
{"name": "web-cgi-traffic_important_update", "file_path": "www/traffic_start_update.htm", "location": "www/traffic_start_update.htm", "risk_score": 0.0, "confidence": 4.5, "description": "The file 'www/traffic_start_update.htm' references 'traffic_important_update.htm', which contains an auto-submitting form that uses the POST method to submit to 'traffic_important_update.cgi'. This indicates that 'traffic_important_update.cgi' is a CGI script handling HTTP requests and could be a potential target for security analysis. However, this CGI file was not found in the current directory.", "link_identifiers": ["traffic_important_update.cgi", "tm_important_update", "POST"], "notes": "Further analysis of the 'traffic_important_update.cgi' file is required, but the file is not present in the current directory. It is recommended to search for this file in other directories for more in-depth analysis."}
{"name": "web-interface-MNU_login_form", "file_path": "www/MNU_login.htm", "location": "MNU_login.htm", "risk_score": 0.0, "confidence": 4.5, "description": "An HTML form was discovered in the 'www/MNU_login.htm' file, which submits data via the POST method to the 'login.cgi' script. The form includes a checkbox 'enable' and a hidden field 'logo_enable', and these parameters will be passed to 'login.cgi' for processing. Since this file is merely a front-end HTML template, the actual HTTP request handling logic resides in 'login.cgi'. Further analysis of this CGI script is required to determine whether security risks exist.", "code_snippet": "<form method=\"POST\" action=\"login.cgi\">\n...\n<input type=\"hidden\" name=\"logo_enable\" value=\"1\">", "link_identifiers": ["login.cgi", "enableFwCheck", "enable", "logo_enable", "POST"], "notes": "It is recommended to proceed with analyzing the 'login.cgi' file, examining its handling of the 'enable' and 'logo_enable' parameters, particularly whether these parameters are passed to dangerous functions such as system() or strcpy()."}
{"name": "web-frontend-start.htm-entrypoints", "file_path": "www/start.htm", "location": "www/start.htm", "risk_score": 6.0, "confidence": 6.0, "description": "Analysis of 'www/start.htm' revealed frontend components that interact with backend services. While no direct dangerous function calls were found in this HTML file, it contains important entry points for backend analysis including:\n1. Form 'frmLanguage' with hidden parameters (curlang, srptlang, etc.) for configuration\n2. AJAX calls to backend scripts like 'usb_check.php'\n3. Multiple hidden parameters used for device configuration\n4. Dynamic content loading mechanisms\n\nThese frontend elements provide pathways to backend processing that should be investigated for dangerous function usage.", "link_identifiers": ["frmLanguage", "curlang", "srptlang", "local_srptlang", "auto_block", "loadPage", "loadPage2", "usb_check.php", "enable_apmode", "enable_stamode", "enable_extmode", "enable_circle", "have_usb_attached"], "notes": "Recommended next steps:\n1. Analyze whether backend scripts (such as 'usb_check.php') contain dangerous function calls\n2. Investigate how the backend service processes hidden parameters\n3. Check if dynamic content loading targets contain vulnerabilities"}
{"name": "web-component-analysis-welcome_genie", "file_path": "www/welcome.htm", "location": "www/welcome.htm, www/genie_top.htm", "risk_score": 0.0, "confidence": 4.0, "description": "Analysis of the 'www/welcome.htm' and 'www/genie_top.htm' files revealed no direct forms or links pointing to CGI scripts or binary files. The files contain dynamic content markers, but no related discovery records exist in the knowledge base for these markers. It is recommended to shift focus to analyzing other web service component files, particularly CGI scripts or binary files, to identify potential vulnerabilities.", "link_identifiers": ["frame_back.htm", "genie_top.htm", "<%2440%>", "<%2441%>", "<%11%>", "<%2941%>", "<%325%>", "<%326%>", "<%12%>", "<%2969%>", "<%2970%>", "<%2971%>", "<%2972%>"], "notes": "It is recommended to further analyze other web service component files, particularly CGI scripts or binary files, to identify potential vulnerabilities."}
{"name": "network_input-genie.cgi-HTTP_parameter_processing", "file_path": "www/cgi-bin/genie.cgi", "location": "REDACTED_SENSITIVE_DATA", "risk_score": 3.0, "confidence": 6.25, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["getenv", "QUERY_STRING", "REDACTED_SENSITIVE_DATA", "fcn.00009ef8", "snprintf", "popen", "strncpy", "curl_easy_perform"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "web-component-showHelp.js-http-input", "file_path": "www/cgi-bin/showHelp.js", "location": "showHelp.js", "risk_score": 0.0, "confidence": 4.5, "description": "Analysis of the 'www/cgi-bin/showHelp.js' file revealed no code segments that pass HTTP input to dangerous functions (such as eval, exec, etc.). The file primarily contains functionality for controlling the display of help frames and loading help documents, with no apparent use of any hazardous functions. However, it should be noted that the 'fname' and 'anchname' parameters may originate from HTTP input, and it is recommended to further examine the source and validation of these parameters.", "code_snippet": "window.frames['helpframe'].location.href=fname+'_h.htm#' + anchname;", "link_identifiers": ["loadhelp", "fname", "anchname", "window.frames", "location.href"], "notes": "Although no direct dangerous function calls were found, it is important to note that the 'fname' and 'anchname' parameters may originate from HTTP input. It is recommended to further examine the sources and validation of these parameters."}
{"name": "web-redirect-changeUrl-open_redirect", "file_path": "www/cgi-bin/changeUrl.js", "location": "www/cgi-bin/changeUrl.js: change_url function", "risk_score": 6.0, "confidence": 8.0, "description": "The `change_url(file_name)` function in the file 'www/cgi-bin/changeUrl.js' contains an open redirect vulnerability. This function takes the `file_name` parameter and directly concatenates it into a new URL (redirecting via `top.location.href`) without any validation or filtering. An attacker can craft a malicious `file_name` parameter to redirect users to arbitrary malicious websites. Although this is not a direct command injection or buffer overflow vulnerability, open redirect remains a security issue that could be exploited for phishing attacks.", "code_snippet": "function change_url(file_name)\n{\n    \n    if(\"www.mywifiext.com\" == check_top_url())\n        top.location.href = \"http://www.mywifiext.net\" + \"/\" + file_name;\n    else if(\"www.mywifiext.net\" == check_top_url())\n        top.location.href = \"http://mywifiext.com\" + \"/\" + file_name;\n    else if(\"mywifiext.com\" == check_top_url())\n        top.location.href = \"http://mywifiext.net\" + \"/\" + file_name;\n    else if(\"mywifiext.net\" == check_top_url())\n        top.location.href = \"http://www.mywifiext.com\" + \"/\" + file_name;\n    else \n        top.location.href = file_name;\n}", "link_identifiers": ["change_url", "file_name", "top.location.href", "check_top_url"], "notes": "Although there are no direct calls to dangerous functions (such as system, strcpy, etc.), the open redirect vulnerability remains a security issue. It is recommended to implement strict validation and filtering of the file_name parameter to ensure it points to a legitimate internal URL. Subsequent checks can focus on other CGI scripts or binary files to identify more direct command injection or buffer overflow vulnerabilities."}
{"name": "web-validation-opmode-utils", "file_path": "www/cgi-bin/opmode.js", "location": "www/cgi-bin/opmode.js", "risk_score": 5.0, "confidence": 6.5, "description": "The 'opmode.js' file contains utility functions for input validation (IP/MAC addresses, security keys) but does not directly process HTTP parameters or call dangerous functions. While no direct vulnerabilities were found in this file, its validation functions (checkipaddr, maccheck, etc.) are used throughout the web interface and could contribute to security issues if improperly called.", "code_snippet": "function checkipaddr(ipaddr) {\n  var form = document.forms[0];\n  var ipArray = ipaddr.split(\".\");\n  var ipstr = ipArray[0]+ipArray[1]+ipArray[2]+ipArray[3];\n  var i = 0;\n\n  if((ipArray[0]==\"\")||(ipArray[0]<0)||(ipArray[0]>255)||(ipArray[1]==\"\")||(ipArray[1]<0)||(ipArray[1]>255)\n      ||(ipArray[2]==\"\")||(ipArray[2]<0)||(ipArray[2]>255)||(ipArray[3]==\"\")||(ipArray[3]<0)||(ipArray[3]>255))\n  {\n    return false;\n  }", "link_identifiers": ["checkipaddr", "maccheck", "checkwep", "checkpsk", "format_IP", "isValidChar", "isValidMac"], "notes": "configuration_load"}
{"name": "config-file-icon_paths", "file_path": "etc/lld2d.conf", "location": "etc/lld2d.conf", "risk_score": 0.0, "confidence": 5.0, "description": "After analyzing the 'etc/lld2d.conf' file, no configuration items related to web service components were found. The file content only includes icon path configurations ('/etc/small.ico' and '/etc/large.ico'), with no configurations involving CGI scripts, binary file paths, or HTTP parameter processing.", "code_snippet": "icon = /etc/small.ico\njumbo-icon = /etc/large.ico", "link_identifiers": ["icon", "jumbo-icon", "/etc/small.ico", "/etc/large.ico"], "notes": "It is recommended to check other configuration files or directories (such as '/etc/httpd/' or '/www/cgi-bin/') to locate the relevant configurations for web service components."}
{"name": "configuration-forked-daapd-001", "file_path": "etc/forked-daapd.conf", "location": "etc/forked-daapd.conf", "risk_score": 2.0, "confidence": 5.0, "description": "Analysis of the 'etc/forked-daapd.conf' file revealed no configuration items directly related to web services. The file primarily configures general parameters and library settings for the forked-daapd music server, without containing valid configurations for HTTP ports, CGI paths, or web interfaces. The 'REDACTED_PASSWORD_PLACEHOLDER' is set to 'unused', and the service port is 3689 (DAAP protocol), indicating that this configuration file does not involve HTTP web services.", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["REDACTED_PASSWORD_PLACEHOLDER", "port", "uid", "logfile", "loglevel", "directories"], "notes": "Consider further analyzing other files or directories to identify potential web service components."}
{"name": "web-cgi-symbolic-links", "file_path": "etc/init.d/remote.sh", "location": "remote.sh", "risk_score": 0.0, "confidence": 3.5, "description": "The remote.sh script configures the web service settings and creates symbolic links, connecting RMT_invite.cgi and func.sh to the /tmp/www/cgi-bin directory. These CGI scripts may handle HTTP requests, but since the files are not within the current working directory, it cannot be confirmed whether HTTP inputs are passed to hazardous functions. Further analysis of these CGI scripts is required to determine if security risks exist.", "code_snippet": "N/A (HIDDEN)", "link_identifiers": ["RMT_invite.cgi", "func.sh", "/tmp/www/cgi-bin", "leafp2p_remote_url", "leafp2p_replication_url"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "script-analysis-leafp2p_sh", "file_path": "etc/init.d/leafp2p.sh", "location": "leafp2p.sh", "risk_score": 0.0, "confidence": 4.0, "description": "Analysis of the leafp2p.sh script is complete. No startup commands or invoked programs related to web services were found. The script is primarily used to start and stop processes related to checkleafnets.sh and leafp2p, with no direct evidence of handling HTTP requests or calling dangerous functions (such as system, strcpy, sprintf, etc.).", "link_identifiers": ["leafp2p.sh", "checkleafnets.sh", "leafp2p", "start", "stop"], "notes": "For further analysis, it is necessary to examine the contents of the checkleafnets.sh script, but this script is not in the currently accessible directory."}
