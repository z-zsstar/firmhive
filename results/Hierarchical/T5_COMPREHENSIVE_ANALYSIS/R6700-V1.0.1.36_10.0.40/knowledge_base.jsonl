{"name": "config-REDACTED_SECRET_KEY_PLACEHOLDER-group-permissions", "file_path": "etc/group", "location": "etc/group", "risk_score": 7.5, "confidence": 7.5, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "", "link_identifiers": ["group", "REDACTED_PASSWORD_PLACEHOLDER", "REDACTED_PASSWORD_PLACEHOLDER", "guest", "GID"], "notes": "configuration_load"}
{"name": "NVRAM-Operation-eapd-0000f774", "file_path": "bin/eapd", "location": "bin/eapd:0x0000f774", "risk_score": 8.0, "confidence": 7.5, "description": "In the 'bin/eapd' file, the function 'fcn.0000f774' retrieves values using 'nvram_get' without performing adequate boundary checks. An attacker may exploit this by manipulating relevant parameters in NVRAM to trigger security issues. Trigger conditions include the attacker's ability to control input network interface names or related configuration parameters. Potential impacts include buffer overflow or privilege escalation and network configuration tampering due to insufficiently validated wireless network operations.", "code_snippet": "strncpy(dest, src, size);\nsprintf(s, format, ...);\nwl_ioctl(wl, cmd, buf, len);", "link_identifiers": ["nvram_get", "fcn.0000f774", "lan_ifname", "wan_ifnames"], "notes": "Further verification is required to determine whether these functions can be triggered by external inputs and whether the inputs can be controlled by attackers. It is recommended to examine the calling context of these functions to identify if any actual attack paths exist."}
{"name": "Network-Interface-eapd-00009fbc", "file_path": "bin/eapd", "location": "bin/eapd:0x00009fbc", "risk_score": 8.0, "confidence": 7.5, "description": "In the 'bin/eapd' file, the function 'fcn.00009fbc' utilizes unsafe string manipulation functions (such as 'strncpy' and 'sprintf'), which may lead to buffer overflow or format string vulnerabilities. Attackers could potentially exploit these issues by controlling input network interface names or related configuration parameters. Potential security impacts include code execution or information disclosure.", "code_snippet": "strncpy(dest, src, size);\nsprintf(s, format, ...);", "link_identifiers": ["strncpy", "sprintf", "fcn.00009fbc"], "notes": "Further verification is needed to determine whether these functions can be triggered by external input and whether the input can be controlled by attackers. It is recommended to examine the calling context of these functions to identify if any actual attack paths exist."}
{"name": "Wireless-Operation-eapd-00009c94", "file_path": "bin/eapd", "location": "bin/eapd:0x00009c94", "risk_score": 8.0, "confidence": 7.5, "description": "In the 'bin/eapd' file, the function 'fcn.00009c94' invokes sensitive operations such as 'wl_ioctl' and 'wl_hwaddr' without adequate input validation. Attackers may potentially trigger the execution of related functions through certain means, leading to insufficiently validated wireless network operations. Potential impacts include privilege escalation or network configuration tampering.", "code_snippet": "wl_ioctl(wl, cmd, buf, len);", "link_identifiers": ["wl_ioctl", "wl_hwaddr", "fcn.00009c94"], "notes": "Further verification is needed to determine whether these functions can be triggered by external input and whether the input can be controlled by an attacker. It is recommended to examine the calling context of these functions to identify potential attack paths."}
{"name": "script-remote.sh-symlink_risk", "file_path": "etc/init.d/remote.sh", "location": "remote.sh", "risk_score": 7.5, "confidence": 7.0, "description": "A symbolic link creation risk was identified in the 'etc/init.d/remote.sh' script. The script creates multiple symbolic links (such as linking /tmp/www/cgi-bin to externally controllable paths), which could potentially be exploited for path traversal attacks. Attackers might gain access to or modify sensitive files by controlling the paths referenced by these symbolic links.", "code_snippet": "", "link_identifiers": ["ln -s", "/tmp/www/cgi-bin", "/tmp/www/pluging"], "notes": "It is recommended to further analyze the content of the file pointed to by the symbolic link."}
{"name": "script-remote.sh-nvram_risk", "file_path": "etc/init.d/remote.sh", "location": "remote.sh", "risk_score": 7.5, "confidence": 7.0, "description": "The script 'etc/init.d/remote.sh' was found to have unvalidated NVRAM operations. The script extensively uses NVRAM operations (such as 'nvram get' and 'nvram set') without properly validating values retrieved from NVRAM. These values could be tainted and potentially lead to injection attacks in other components.", "code_snippet": "", "link_identifiers": ["nvram get", "nvram set", "leafp2p_sys_prefix", "leafp2p_replication_url", "leafp2p_remote_url"], "notes": "It is recommended to further analyze the usage patterns of NVRAM values in other components."}
{"name": "script-remote.sh-url_risk", "file_path": "etc/init.d/remote.sh", "location": "remote.sh", "risk_score": 7.5, "confidence": 7.0, "description": "A risk of external URL dependency was identified in the 'etc/init.d/remote.sh' script. The script sets multiple NVRAM default values, including external URLs (such as readyshare.netgear.com and peernetwork.netgear.com). These external dependencies could be exploited through man-in-the-middle attacks, potentially leading to data leakage or malicious code injection.", "code_snippet": "", "link_identifiers": ["leafp2p_replication_url", "leafp2p_remote_url"], "notes": "It is recommended to further analyze the security verification mechanism for external URL connections."}
{"name": "auth-eap-pppd-critical", "file_path": "sbin/pppd", "location": "sbin/pppd", "risk_score": 9.0, "confidence": 8.25, "description": "The EAP authentication mechanism contains critical vulnerabilities:  \n- Insufficient input validation (improper use of strlen)  \n- Lack of error checking in memory allocation (malloc)  \n- Use of weak random number generator (drand48)  \n- Flaws in complex state transition logic  \n\nAttackers can chain these vulnerabilities to bypass authentication, leak information, or even achieve remote code execution.  \n\nExploit chain: Attackers can send crafted EAP authentication packets via the network interface → trigger input validation flaws → exploit memory management issues → potentially lead to remote code execution.", "code_snippet": "Not provided in original data", "link_identifiers": ["eap_authwithpeer", "eap_authpeer", "strlen", "malloc", "drand48"], "notes": "network_input"}
{"name": "auth-mschap-pppd-high", "file_path": "sbin/pppd", "location": "sbin/pppd", "risk_score": 8.0, "confidence": 7.75, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided in original data", "link_identifiers": ["ChapMS", "ChapMS2", "mppe_set_keys", "drand48", "memcpy"], "notes": "network_input"}
{"name": "auth-pap-pppd-medium", "file_path": "sbin/pppd", "location": "sbin/pppd", "risk_score": 7.0, "confidence": 7.5, "description": "The PAP authentication mechanism has buffer overflow risks and brute-force cracking vulnerabilities:  \n- Lack of boundary checks when copying REDACTED_PASSWORD_REDACTED_PASSWORD_PLACEHOLDER via memcpy  \n- No retry limit implemented  \n\nThis may lead to authentication bypass or service crashes.", "code_snippet": "Not provided in original data", "link_identifiers": ["upap_authpeer", "upap_authwithpeer", "memcpy", "timeout"], "notes": "There is a risk of brute force attacks and buffer overflow exploits."}
{"name": "file-secrets-pppd-medium", "file_path": "sbin/pppd", "location": "sbin/pppd", "risk_score": 6.5, "confidence": 6.5, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided in original data", "link_identifiers": ["sym.get_secret", "sym.imp.fopen", "sym.imp.open", "sym.imp.strlcpy"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "nvram-leafp2p-path-construction", "file_path": "etc/init.d/leafp2p.sh", "location": "etc/init.d/leafp2p.sh", "risk_score": 7.0, "confidence": 7.0, "description": "Potential security issues found in the 'etc/init.d/leafp2p.sh' file:\n1. The command 'nvram get leafp2p_sys_prefix' is used to obtain the system prefix path, which is then utilized to construct script paths and execute commands. If the 'leafp2p_sys_prefix' value is maliciously modified, it could lead to arbitrary command execution or path traversal attacks.\n2. The script directly executes 'checkleafnets.sh' without validating either the path or the script's contents.\n3. The 'stop' function employs the 'killall' command, which may inadvertently terminate other processes.\nPotential impact: Attackers could potentially manipulate NVRAM values to control script execution paths, resulting in arbitrary command execution.", "code_snippet": "SYS_PREFIX=$(${nvram} get leafp2p_sys_prefix)\nCHECK_LEAFNETS=${SYS_PREFIX}/bin/checkleafnets.sh\nPATH=${SYS_PREFIX}/bin:${SYS_PREFIX}/usr/bin:/sbin:/usr/sbin:/bin:/usr/bin\nstart()\n{\n    ${CHECK_LEAFNETS} &\n}", "link_identifiers": ["leafp2p_sys_prefix", "nvram", "checkleafnets.sh", "killall"], "notes": "Further analysis of the 'checkleafnets.sh' script content is required to confirm whether additional security issues exist. Additionally, it is recommended to verify the source of the 'leafp2p_sys_prefix' value and potential tampering pathways."}
{"name": "command-execution-utelnetd-execv", "file_path": "bin/utelnetd", "location": "bin/utelnetd: [sym.imp.execv]", "risk_score": 7.5, "confidence": 7.25, "description": "In the 'bin/utelnetd' file, `sym.imp.execv` is used to execute the `/bin/login` program, with parameters sourced from the global variable `0x9af4`. The current analysis has not identified any direct external input control paths, but further verification of the global variable initialization process is required. Potential risks include command injection or execution of unauthorized commands.", "code_snippet": "sym.imp.execv(\"/bin/login\", 0x9af4);", "link_identifiers": ["sym.imp.execv", "0x9af4", "fcn.000090a4"], "notes": "It is recommended to further analyze the initialization and modification paths of the global variable `0x9af4`."}
{"name": "network-input-utelnetd-setsockopt", "file_path": "bin/utelnetd", "location": "bin/utelnetd: [sym.imp.setsockopt]", "risk_score": 6.0, "confidence": 6.25, "description": "In the 'bin/utelnetd' file, no obvious buffer overflow vulnerabilities were found in the network processing logic for `sym.imp.accept` and `sym.imp.setsockopt`. However, the `SO_BINDTODEVICE` option lacks sufficient validation of interface names, which could potentially be exploited for network isolation bypass.", "code_snippet": "sym.imp.setsockopt(fd, SOL_SOCKET, SO_BINDTODEVICE, ifname, strlen(ifname));", "link_identifiers": ["sym.imp.accept", "sym.imp.setsockopt", "SO_BINDTODEVICE", "iVar14"], "notes": "It is recommended to further analyze the source of the interface name and the validation logic for the `SO_BINDTODEVICE` option."}
{"name": "process-management-utelnetd-fork", "file_path": "bin/utelnetd", "location": "bin/utelnetd: [sym.imp.fork]", "risk_score": 5.5, "confidence": 6.0, "description": "In the 'bin/utelnetd' file, `sym.imp.fork` is used in daemon processes and network connection handling, but lacks error handling and resource cleanup, potentially leading to zombie processes or resource leaks.", "code_snippet": "pid = sym.imp.fork();\nif (pid == 0) {\n    // Child process logic\n}", "link_identifiers": ["sym.imp.fork", "puVar22"], "notes": "It is recommended to further analyze the resource cleanup and error handling of child processes after `fork`."}
{"name": "buffer-overflow-utelnetd-strcpy", "file_path": "bin/utelnetd", "location": "bin/utelnetd: [strcpy]", "risk_score": 8.0, "confidence": 7.75, "description": "In the 'bin/utelnetd' file, `strcpy` is used to copy the pseudo-terminal device name returned by `ptsname` without length checking, which may lead to buffer overflow.", "code_snippet": "strcpy(buffer, ptsname(fd));", "link_identifiers": ["strcpy", "ptsname"], "notes": "It is recommended to further analyze the source string origin and length validation of `strcpy`."}
{"name": "network_input-fbwifi-api_endpoint", "file_path": "bin/fbwifi", "location": "bin/fbwifi", "risk_score": 7.0, "confidence": 8.5, "description": "The hardcoded Facebook API endpoint 'https://graph.facebook.com/wifiauth' may be used for authentication, but its security has not been verified. This endpoint could potentially handle sensitive data, yet the lack of security validation may lead to data breaches or man-in-the-middle attacks.", "link_identifiers": ["https://graph.facebook.com", "/wifiauth"], "notes": "Further verification is required regarding the usage scenarios and security of this API endpoint."}
{"name": "configuration_load-fbwifi-base64_credential", "file_path": "bin/fbwifi", "location": "bin/fbwifi", "risk_score": 8.5, "confidence": 7.25, "description": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["REDACTED_SENSITIVE_DATA"], "notes": "REDACTED_SENSITIVE_DATA"}
{"name": "file_read-fbwifi-credentials_xml", "file_path": "bin/fbwifi", "location": "bin/fbwifi", "risk_score": 6.5, "confidence": 7.0, "description": "The configuration file path 'credentials.xml' has been detected, but its contents and location cannot be confirmed. If this file contains sensitive information and its location is externally accessible, there may be a risk of information leakage.", "link_identifiers": ["credentials.xml"], "notes": "Check if the 'credentials.xml' file contains any sensitive information."}
{"name": "nvram_set-fbwifi-nvram_operations", "file_path": "bin/fbwifi", "location": "bin/fbwifi", "risk_score": 7.5, "confidence": 8.25, "description": "Detected NVRAM operation commands 'nvram set', 'nvram commit', 'nvram get', but unable to assess their safety. NVRAM operations could potentially be exploited by attackers to modify system configurations or obtain sensitive information.", "link_identifiers": ["nvram set", "nvram commit", "nvram get"], "notes": "Analyze the security of NVRAM operations, particularly whether these operations are affected by external inputs."}
{"name": "command-injection-nvram-system", "file_path": "sbin/bd", "location": "sbin/bd:0x00008e7c (system call)", "risk_score": 8.5, "confidence": 7.75, "description": "The command injection vulnerability exists in the NVRAM configuration value processing flow. The specific path is: 1) Retrieving configuration values from NVRAM (acosNvramConfig_get) 2) Unsafely copying to a stack buffer using strcpy 3) Ultimately using this value in a system call. Attackers can inject malicious commands by manipulating NVRAM values.", "link_identifiers": ["acosNvramConfig_get", "strcpy", "system", "iVar6", "uVar4"], "notes": "Verify whether NVRAM values can be modified through network interfaces or other input points"}
{"name": "buffer-overflow-nvram-handling", "file_path": "sbin/bd", "location": "sbin/bd:0x0000953c", "risk_score": 8.0, "confidence": 7.5, "description": "The NVRAM interaction vulnerability exists in the processing of multiple configuration values. The function 'fcn.0000953c' retrieves NVRAM values such as network settings and security configurations, copying them to a local buffer using strcpy without length checks, which may lead to buffer overflow. The lack of input validation makes the system vulnerable to injection attacks.", "link_identifiers": ["acosNvramConfig_get", "strcpy", "fcn.0000953c", "LAN IP", "WLAN SSID"], "notes": "Analyze which NVRAM values can be modified through external interfaces and the permission requirements for modification"}
{"name": "systemic-drand48-weakness", "file_path": "sbin/pppd", "location": "sbin/pppd", "risk_score": 9.5, "confidence": 8.75, "description": "Systemic Security Risk: Weak random number generator (drand48) shared across multiple critical authentication mechanisms.\n\nAffected Components:\n1. EAP Authentication Mechanism (Risk Score 9.0)\n2. MS-CHAP Authentication Mechanism (Risk Score 8.0)\n\nComposite Impact:\n- Attackers can exploit this shared weakness to simultaneously target multiple authentication protocols\n- Predicting random numbers for one protocol may facilitate attacks on others\n- Resolution requires coordinated replacement of all components using drand48\n\nRecommendations:\n- Globally replace drand48 with secure random number generators (e.g., getrandom or /dev/urandom)\n- Conduct unified security audits for all authentication protocols", "code_snippet": "Not provided in original data", "link_identifiers": ["drand48", "eap_authwithpeer", "eap_authpeer", "ChapMS", "ChapMS2"], "notes": "system_weakness"}
{"name": "service-afpd-config-tampering", "file_path": "etc/init.d/afpd", "location": "afpdHIDDEN", "risk_score": 7.5, "confidence": 7.25, "description": "A comprehensive analysis has identified multiple potential security issues in the afpd service: 1) The copying operation of the AppleVolumes.default file lacks security controls, which may lead to configuration tampering; 2) The implementations of critical functions update_user and update_afp are not visible, requiring an expanded scope of analysis; 3) The integrity of the send_wol background process cannot be verified. These findings form a potential complete attack path: attackers could tamper with the AppleVolumes.default file → affect afpd service configuration → combine with unverified update_afp function → ultimately achieve privilege escalation or service control.", "link_identifiers": ["AppleVolumes.default", "AFP_CONF_DIR", "update_user", "update_afp", "/usr/sbin/send_wol"], "notes": "Suggested follow-up analysis: 1) Expand the analysis scope to locate the update_user/update_afp functions; 2) Obtain the send_wol file for detailed analysis; 3) Check the permission settings of the /tmp/netatalk directory. User confirmation is required to proceed with expanding the analysis scope."}
{"name": "ssl_tls-wget-SSL_VERIFY_NONE", "file_path": "bin/wget", "location": "fcn.0002c02c, fcn.0002c390", "risk_score": 8.5, "confidence": 8.25, "description": "A critical SSL/TLS implementation flaw was discovered in the 'bin/wget' file, primarily including: 1) Explicit disabling of certificate verification (SSL_VERIFY_NONE), 2) Potential bypass of hostname verification, 3) Inadequate error handling. These vulnerabilities enable attackers to perform man-in-the-middle attacks, establish connections using invalid certificates, or conduct phishing attacks.", "code_snippet": "sym.imp.SSL_CTX_set_verify(*piVar5,0,0);", "link_identifiers": ["SSL_CTX_set_verify", "SSL_VERIFY_NONE", "SSL_get_peer_certificate", "fcn.0002bc88", "X509_get_subject_name"], "notes": "These vulnerabilities can be triggered by any operation using wget for HTTPS connections. It is recommended to inspect all scripts and programs in the firmware that invoke wget to assess the actual risks. Additionally, enabling certificate verification and strengthening hostname checks are advised."}
{"name": "cross-component-auth-vulnerability", "file_path": "sbin/pppd", "location": "bin/eapd & sbin/pppd", "risk_score": 9.0, "confidence": 8.25, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Multiple components involved", "link_identifiers": ["nvram_get", "eap_authpeer", "wl_ioctl", "strncpy", "drand48"], "notes": "system_weakness"}
{"name": "nvram-unvalidated-input", "file_path": "sbin/rc", "location": "sbin/rc (multiple locations)", "risk_score": 7.5, "confidence": 7.25, "description": "The NVRAM operations (nvram_get/nvram_set) carry risks of unvalidated input. Functions fcn.0000b198 and fcn.0000d8cc directly utilize NVRAM values for control flow decisions and ioctl calls without adequate validation. Attackers may manipulate system behavior by modifying NVRAM values.", "link_identifiers": ["fcn.0000b198", "fcn.0000d8cc", "nvram_get", "nvram_set", "ioctl"], "notes": "Further verification is required regarding the source of NVRAM values and potential control paths."}
{"name": "env-injection", "file_path": "sbin/rc", "location": "fcn.00018c48", "risk_score": 7.5, "confidence": 7.5, "description": "The environment variable operations (getenv/setenv) pose an injection risk. Function fcn.00018c48 directly uses environment variable values to configure NVRAM and perform network operations without validation. Attackers could potentially manipulate system configurations by controlling environment variables.", "link_identifiers": ["getenv", "nvram_set", "inet_aton", "fcn.00018c48"], "notes": "env_get/env_set"}
{"name": "command-execution-risk", "file_path": "sbin/rc", "location": "sbin/rc (multiple locations)", "risk_score": 6.0, "confidence": 6.0, "description": "Command execution (system/kill) uses hardcoded values, but if these values can be controlled via NVRAM or environment variables, there is a risk of command injection. The primary method for executing commands is through the _eval function.", "link_identifiers": ["system", "kill", "_eval"], "notes": "Verify whether command parameters are affected by NVRAM or environment variables."}
{"name": "device-file-operation", "file_path": "sbin/rc", "location": "sbin/rc (multiple locations)", "risk_score": 4.0, "confidence": 6.0, "description": "File operations (mknod/mount) use hardcoded paths and permission modes (0x21c0), with no path injection risks identified. The permissions are set to S_IFCHR|0600, indicating a character device file with read and write permissions for the owner.", "link_identifiers": ["mknod", "mount", "0x21c0", "S_IFCHR"], "notes": "Reasonable permission settings, but potential privilege escalation paths still need to be monitored."}
{"name": "network_input-genie.cgi-query_string_injection", "file_path": "www/cgi-bin/genie.cgi", "location": "genie.cgi", "risk_score": 8.5, "confidence": 8.0, "description": "The genie.cgi script has a potential injection vulnerability when processing QUERY_STRING, which may allow attackers to inject malicious code or parameters. Trigger conditions include constructing malicious request parameters. Successful exploitation could lead to system command execution or sensitive information disclosure.", "code_snippet": "Not provided", "link_identifiers": ["sym.imp.nvram_get", "sym.imp.nvram_set", "sym.imp.nvram_commit", "strncpy", "strstr", "printf", "snprintf", "t=%s&d=%s&c=%s", "REDACTED_SENSITIVE_DATA", "curl_easy_perform"], "notes": "It is recommended to perform strict validation and filtering on all input parameters."}
{"name": "nvram_set-genie.cgi-buffer_overflow", "file_path": "www/cgi-bin/genie.cgi", "location": "genie.cgi", "risk_score": 8.5, "confidence": 8.0, "description": "The code in the genie.cgi script that interacts with NVRAM poses a buffer overflow risk and lacks parameter validation for nvram_set calls. Trigger conditions include exploiting unvalidated input parameters. Successful exploitation could lead to tampering with NVRAM configurations.", "code_snippet": "Not provided", "link_identifiers": ["sym.imp.nvram_get", "sym.imp.nvram_set", "sym.imp.nvram_commit", "strncpy", "snprintf"], "notes": "It is recommended to fix the buffer overflow vulnerability and implement secure NVRAM operation guidelines."}
{"name": "network_input-genie.cgi-remote_connection_vulnerabilities", "file_path": "www/cgi-bin/genie.cgi", "location": "genie.cgi", "risk_score": 8.5, "confidence": 8.0, "description": "The genie.cgi script has vulnerabilities in remote connection handling, including sensitive information leakage, command injection risks, unauthorized access, and man-in-the-middle attacks. Trigger conditions include intercepting network communications and constructing malicious requests. Successful exploitation may lead to system command execution, sensitive information disclosure, or unauthorized access to system functions.", "code_snippet": "Not provided", "link_identifiers": ["curl_easy_perform", "REDACTED_SENSITIVE_DATA", "t=%s&d=%s&c=%s"], "notes": "It is recommended to enhance the security of remote connections, including certificate verification, and implement a comprehensive access control mechanism."}
{"name": "utility-js-security-assessment", "file_path": "www/utility.js", "location": "www/utility.js", "risk_score": 2.0, "confidence": 5.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "", "link_identifiers": ["setInterval", "picMarquee_interent", "picMarquee_wireless", "isIPaddr", "isValidIPaddr", "checkMacStr", "innerHTML", "get_browser", "navigator.userAgent"], "notes": "Recommendations: 1) Monitor innerHTML usage to prevent XSS; 2) Maintain strict input validation; 3) Review other files calling these utility functions to verify complete data flow security. Current file analysis completed with no exploitable attack paths identified."}
{"name": "vulnerability-buffer_overflow-fcn0000c9ac", "file_path": "bin/wps_monitor", "location": "bin/wps_monitor:0xc9ac (fcn.0000c9ac)", "risk_score": 9.0, "confidence": 8.25, "description": "The function fcn.0000c9ac contains unverified strcpy and strcat operations, which may lead to arbitrary code execution or service crashes. Attackers could exploit this buffer overflow vulnerability by crafting malicious input.", "code_snippet": "strcpy(dest, src);\nstrcat(dest, input);", "link_identifiers": ["fcn.0000c9ac", "strcpy", "strcat"], "notes": "It is recommended to use strncpy/strncat instead of strcpy/strcat and add length checks."}
{"name": "vulnerability-upnp_service-upnp_dispatch", "file_path": "bin/wps_monitor", "location": "bin/wps_monitor: (upnp_dispatch)", "risk_score": 9.0, "confidence": 7.75, "description": "The UPnP service implementation contains vulnerabilities of unauthorized access and buffer overflow, which can be exploited by attackers sending specially crafted UPnP requests over the network. Attack path: network interface → UPnP request processing → buffer overflow.", "code_snippet": "upnp_dispatch(request);\nupnp_get_in_tlv(input);", "link_identifiers": ["upnp_dispatch", "upnp_get_in_tlv", "recvmsg"], "notes": "These vulnerabilities could be exploited in combination by attackers to form a complete attack chain. It is recommended to prioritize fixing the buffer overflow and UPnP service vulnerabilities."}
{"name": "vulnerability-nvram_injection-nvram_operations", "file_path": "bin/wps_monitor", "location": "bin/wps_monitor: (nvram_get/nvram_set)", "risk_score": 7.0, "confidence": 6.5, "description": "nvram_get/nvram_set  \n\nThere is an injection risk during NVRAM configuration parameter processing, where attackers can affect system behavior by tampering with NVRAM configurations. Attack path: NVRAM configuration tampering → UPnP service abnormal behavior.", "code_snippet": "nvram_get(\"upnp_config\");\nnvram_set(\"upnp_config\", value);", "link_identifiers": ["nvram_get", "nvram_set", "nvram_commit"], "notes": "Integrity check of NVRAM configuration parameters is recommended."}
{"name": "vulnerability-sbin-acos_service-strcpy_overflow", "file_path": "sbin/acos_service", "location": "sbin/acos_service", "risk_score": 8.0, "confidence": 7.25, "description": "A buffer overflow vulnerability was discovered in the '/sbin/acos_service' file: The use of strcpy to retrieve data from NVRAM without length validation may lead to stack overflow (located at the main function's stack frame r5-0xc). Trigger condition: When an attacker can control relevant variables in NVRAM, they may exploit this by crafting an excessively long string to trigger stack overflow. Potential impacts include arbitrary code execution and system control takeover.", "code_snippet": "Not provided in original finding", "link_identifiers": ["strcpy", "main", "r5-0xc", "acosNvramConfig_get"], "notes": "It is recommended to subsequently verify the exploitability of the strcpy vulnerability and analyze the data flow integrity of NVRAM operations."}
{"name": "hardcoded_credential-sbin-acos_service-wps_pin", "file_path": "sbin/acos_service", "location": "sbin/acos_service", "risk_score": 6.0, "confidence": 8.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided in original finding", "link_identifiers": ["REDACTED_SENSITIVE_DATA"], "notes": "Check the actual usage scenarios of hardcoded credentials"}
{"name": "hardcoded_credential-sbin-acos_service-guest_account", "file_path": "sbin/acos_service", "location": "sbin/acos_service", "risk_score": 6.5, "confidence": 8.0, "description": "REDACTED_SENSITIVE_DATA", "code_snippet": "Not provided in original finding", "link_identifiers": ["guest", "REDACTED_PASSWORD_PLACEHOLDER"], "notes": "Check the actual usage scenarios of hardcoded credentials."}
{"name": "privilege_escalation-sbin-acos_service-network_ops", "file_path": "sbin/acos_service", "location": "sbin/acos_service", "risk_score": 7.0, "confidence": 6.5, "description": "In the 'sbin/acos_service' file, direct manipulation of network interfaces and firewall rules was detected, posing a privilege escalation risk. Attackers could potentially modify network configurations or bypass security restrictions by controlling relevant parameters.", "code_snippet": "Not provided in original finding", "link_identifiers": ["/dev/net/tun"], "notes": "Audit the data flow of network interface operations"}
{"name": "command_injection-sbin-acos_service-system_calls", "file_path": "sbin/acos_service", "location": "sbin/acos_service", "risk_score": 7.5, "confidence": 6.5, "description": "Multiple instances of command execution via system() calls were found in the 'sbin/acos_service' file. Although no direct injection points have been identified currently, vigilance is still required. If attackers gain control over input parameters, it could potentially lead to command injection.", "code_snippet": "Not provided in original finding", "link_identifiers": ["system"], "notes": "Audit the parameter construction process of all system() calls"}
{"name": "input-validation-basic-checkipaddr", "file_path": "www/funcs.js", "location": "HIDDEN", "risk_score": 6.0, "confidence": 8.0, "description": "The input validation functions (checkipaddr, checksubnet, etc.) only perform basic format checks and lack security filtering measures. Attackers may bypass validation through carefully crafted inputs, leading to injection attacks. Trigger condition: When these validation functions are used to process user-controllable inputs.", "link_identifiers": ["checkipaddr", "checksubnet", "checkgateway", "maccheck"], "notes": "The actual risk needs to be assessed in conjunction with specific usage scenarios."}
{"name": "crypto-insecure-md5-PassPhrase40", "file_path": "www/funcs.js", "location": "HIDDEN", "risk_score": 8.5, "confidence": 9.25, "description": "Using MD5 for encryption operations (PassPhrase40, PassPhrase104), MD5 has been proven insecure. Attackers can exploit methods such as rainbow tables to crack the generated keys. Trigger condition: when these functions are used to generate WEP/WPA keys.", "link_identifiers": ["PassPhrase40", "PassPhrase104", "calcMD5"], "notes": "configuration_load"}
{"name": "xss-basic-xssprotect", "file_path": "www/funcs.js", "location": "HIDDEN", "risk_score": 7.0, "confidence": 7.25, "description": "The XSS protection function (xssprotect) only performs basic HTML entity encoding and may not defend against all XSS attacks. Trigger condition: when the function is used to process user input and output to HTML.", "link_identifiers": ["xssprotect"], "notes": "It is recommended to refer to the OWASP XSS Prevention Cheat Sheet for improvements."}
{"name": "redirect-unvalidated-changesectype", "file_path": "www/funcs.js", "location": "HIDDEN", "risk_score": 7.5, "confidence": 7.75, "description": "The URL redirection function (changesectype, change_serv) does not validate the target address, which may lead to an open redirect vulnerability. Trigger condition: when an attacker can control the redirection target parameter.", "link_identifiers": ["changesectype", "change_serv"], "notes": "Add target address whitelist verification"}
{"name": "dom-xss-getObj", "file_path": "www/funcs.js", "location": "HIDDEN", "risk_score": 6.5, "confidence": 6.75, "description": "The DOM manipulation functions (getObj, load_default) do not adequately sanitize input, potentially leading to DOM-based XSS. Trigger condition: when these functions process user-controllable data and modify the DOM.", "link_identifiers": ["getObj", "load_default"], "notes": "Further analysis of specific usage scenarios is required"}
{"name": "input-validation-MAC-address-validation", "file_path": "www/func.js", "location": "func.js:150,208", "risk_score": 7.0, "confidence": 7.5, "description": "Incomplete input validation: The MAC address validation functions 'chkMacLen' and 'MACAddressBlur' only check the length and specific values, without verifying whether the character content consists of valid hexadecimal characters. Attackers can bypass validation by providing non-standard MAC addresses with 12 characters.", "code_snippet": "REDACTED_SENSITIVE_DATA", "link_identifiers": ["chkMacLen", "MACAddressBlur", "MACHIDDEN"], "notes": "It is recommended to implement strict validation of MAC address character content to ensure only valid hexadecimal characters are accepted."}
{"name": "error-handling-template-syntax-exposure", "file_path": "www/func.js", "location": "func.js: chkMacLenHIDDENMACAddressBlurHIDDEN", "risk_score": 6.5, "confidence": 7.5, "description": "Improper error message handling: Multiple instances use the '<%0%>' template syntax to display error messages, potentially exposing internal system structures. Notably, when MAC address validation fails, unprocessed template syntax is directly displayed.", "code_snippet": "alert(\"<%0%>\");", "link_identifiers": ["<%0%>", "alert", "HIDDEN"], "notes": "It is recommended to review all code paths that use the '<%0%>' template syntax and replace them with appropriate error messages."}
{"name": "window-management-XSS-risk", "file_path": "www/func.js", "location": "func.js", "risk_score": 2.0, "confidence": 4.5, "description": "Window Management Function Risk: Although the file name parameter of window management functions such as 'openDataSubWin' is currently uncontrollable, the content of the opened HTML file still needs to be checked for potential XSS risks.", "link_identifiers": ["openDataSubWin", "XSS", "window.open"], "notes": "It is recommended to check the content of the HTML file opened by 'openDataSubWin' to confirm whether there are other potential XSS vulnerabilities."}
