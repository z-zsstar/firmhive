{"name": "PrivEsc-rc.modules", "location": "Files: rc.modules and rcS in /etc/rc.d/", "description": "The 'rc.modules' script is world-writable (permissions: -rwxrwxrwx), allowing any non-root user to modify its content. It is executed with root privileges during system boot via the 'rcS' script, which calls '/etc/rc.d/rc.modules' without any validation or boundary checks. An attacker with non-root access can inject malicious code (e.g., reverse shell or command execution) into 'rc.modules', which will run with root privileges upon the next boot or when 'rcS' is executed. This provides a direct path to privilege escalation and full system compromise. The trigger condition is system boot, and there are no constraints on the content of the modified script.", "link_identifiers": ["/etc/rc.d/rc.modules", "/etc/rc.d/rcS"], "code_snippet": "From rcS: \"/etc/rc.d/rc.modules\"\nFrom rc.modules: The script loads kernel modules but can be replaced with arbitrary code.", "risk_score": 9.0, "confidence": 9.0, "notes": "This vulnerability is exploitable by any authenticated non-root user who can write to 'rc.modules'. Exploitation may require a system reboot to trigger, but it is feasible in scenarios where the attacker has persistent access. Recommended fixes include changing file permissions to root-only write (e.g., chmod 755) and adding integrity checks before execution. No additional files or functions were identified in this analysis that alter the exploit chain.", "file_path": "etc/rc.d/rc.modules"}
{"name": "Command-Injection-apstart", "location": "File:apstart Function:fcn.00400c7c Address:0x00400c7c (Dangerous Operation Point); File:apstart Function:fcn.00400d0c Address:0x00400d0c (Data Flow Processing Point); File:apstart Function:fcn.00400a4c Address:0x00400a4c (Input Parsing Point)", "description": "This vulnerability allows attackers to execute arbitrary commands through a malicious topology file. An attacker as a non-root user (with valid login credentials) can control the topology file content, where configuration values (such as bridge names, interface names) are directly used to build system command strings, lacking input validation and escaping. Trigger condition: When running apstart with a specified topology file path, the file contains a command injection payload (for example, adding semicolons or backticks in configuration values to execute additional commands). Potential exploitation methods include executing system commands, escalating privileges, or compromising system integrity.", "link_identifiers": ["Topology File Path", "ifconfig %s down", "brctl delbr %s", "wlanconfig %s destroy"], "code_snippet": "From the decompiled code, key snippets include:\n  - In fcn.00400c7c: `iVar1 = (**(loc._gp + -0x7f88))(param_1);` (where param_1 is the command string, system() is called).\n  - In fcn.00400d0c: Multiple uses of sprintf to build commands, such as `(**(loc._gp + -0x7fbc))(auStack_f8,\"ifconfig %s down\",iVar17);`, where iVar17 comes from the topology file.\n  - In fcn.00400a4c: Parsing file lines, but without validating the content for safety.", "risk_score": 8.5, "confidence": 9.0, "notes": "This vulnerability relies on the controllability of the topology file. It is recommended to further verify file permissions and access controls in the actual environment. Related functions include main (entry point) and system calls. Subsequent analysis directions include checking other input points (such as network interfaces) and component interactions.", "file_path": "sbin/apstart"}
{"name": "command-injection-wps_set_ap_ssid_configuration", "location": "File:hostapd Address:0x437328-0x43732c Function:sym.wps_set_ap_ssid_configuration", "description": "In the sym.wps_set_ap_ssid_configuration function, user-provided input (from the control interface) is directly used to construct a command string for a system() call (formatted as 'cfg wpssave %s'), without proper input validation or escaping. An attacker can execute arbitrary system commands by injecting malicious commands (such as semicolons or backticks). Trigger condition: An attacker sends a specially crafted WPS configuration command through hostapd's control interface. Potential attacks include obtaining root privileges, filesystem access, or network reconnaissance. The attack chain is complete: input point (control interface socket) → data flow (via sym.eap_wps_config_set_ssid_configuration call) → dangerous operation (system() call). Exploitation condition: The attacker needs permission to access the control interface (non-root user but with valid login credentials).", "link_identifiers": ["Control Interface Socket Path", "IPC Socket Path", "sym.wps_set_ap_ssid_configuration", "sym.eap_wps_config_set_ssid_configuration", "sym.imp.system"], "code_snippet": "// In sym.wps_set_ap_ssid_configuration\n(**(loc._gp + -0x7ddc))(auStack_498, \"cfg wpssave %s\", uStackX_4); // uStackX_4 is user input\nuVar10 = 0;\n(**(loc._gp + -0x7948))(auStack_498); // Call system(auStack_498)", "risk_score": 8.5, "confidence": 9.0, "notes": "Further verification is needed for the specific command format and access control of the control interface, but based on code analysis, an attacker with login credentials can access the control interface. Related function: sym.eap_wps_config_set_ssid_configuration is the direct caller, its input validation should be checked. Recommended follow-up analysis: Check the control interface command processing logic (e.g., sym.hostapd_ctrl_iface_receive) to confirm the attack vector. This vulnerability may affect all embedded devices using hostapd, especially those exposing the control interface.", "file_path": "sbin/hostapd"}
{"name": "Command-Injection-modem_scan", "location": "modem_scan: fcn.00401154 at addresses 0x004012d4-0x004012f4", "description": "A command injection vulnerability exists where the user-controlled '-f' argument is passed directly to execl with '/bin/sh -c', enabling arbitrary command execution. The vulnerability is triggered when both '-d' and '-f' options are provided, with '-f' containing the malicious command. The code uses strncpy with a buffer size of 0x41 bytes (65 bytes) for the '-f' argument, truncating inputs longer than 64 bytes, but still allowing execution of shorter commands. An attacker can exploit this by crafting the '-f' argument to execute commands, potentially leading to further system compromise if combined with other vulnerabilities, though privileges are dropped to the current user.", "link_identifiers": ["Command-line argument '-f'", "Command-line argument '-d'"], "code_snippet": "0x004012d4      3c040040       lui a0, 0x40\n0x004012d8      3c050040       lui a1, 0x40\n0x004012dc      8f998064       lw t9, -sym.imp.execl(gp)   ; [0x401960:4]=0x8f998010\n0x004012e0      3c060040       lui a2, 0x40\n0x004012e4      24841b50       addiu a0, a0, 0x1b50        ; 0x401b50 ; \"/bin/sh\" ; str._bin_sh\n0x004012e8      24a51b58       addiu a1, a1, 0x1b58        ; 0x401b58 ; \"sh\" ; str.sh\n0x004012ec      24c61b5c       addiu a2, a2, 0x1b5c        ; 0x401b5c ; \"-c\" ; str._c\n0x004012f0      02403821       move a3, s2\n0x004012f4      0320f809       jalr t9\n0x004012f8      afa00010       sw zero, (var_10h)", "risk_score": 6.0, "confidence": 9.0, "notes": "The binary was checked for permissions using 'ls -l modem_scan' and found to have standard user executable permissions (e.g., -rwxr-xr-x), indicating no special privileges like setuid. The vulnerability is directly exploitable by an authenticated user but does not escalate privileges beyond the user's own level. Further analysis could involve checking if 'modem_scan' is invoked by other system components with higher privileges, which might increase the risk.", "file_path": "usr/sbin/modem_scan"}
{"name": "BufferOverflow-main", "location": "pppd:0x407f98 main", "description": "In the main function, pppd reads the username and password from the /tmp/pppoe_auth_info file using the read function, which reads directly into a fixed-size buffer without performing bounds checking. If an attacker (non-root user) can write to or create the /tmp/pppoe_auth_info file (since the /tmp directory is typically writable), they can cause a buffer overflow by providing an overly long username or password. This could overwrite the return address or critical data on the stack, thereby executing arbitrary code. Trigger condition: pppd must be running with root privileges (because the main function check requires root), and the /tmp/pppoe_auth_info file exists or can be controlled by the attacker. Potential attack method: The attacker creates a malicious file containing shellcode or address overwrites; when pppd reads the file, it triggers the overflow, potentially resulting in a root shell. Constraint: The buffer size is unknown, but the code does not show dynamic allocation or size checks, so a fixed-size buffer likely exists.", "link_identifiers": ["/tmp/pppoe_auth_info"], "code_snippet": "iVar1 = (**(loc._gp + -0x7b18))(\"/tmp/pppoe_auth_info\",0x4491a4);\nif (iVar1 == 0) {\n    // error handling\n}\npiVar14 = *(loc._gp + -0x7f90);\niVar4 = (**(loc._gp + -0x7af8))(*(loc._gp + -0x7d24),1,*piVar14,iVar1);\nif (iVar4 != *piVar14) {\n    (**(loc._gp + -0x7c54))(\"read username error\\n\");\n}\n// similar for password reading", "risk_score": 7.5, "confidence": 7.0, "notes": "The buffer size is not explicitly defined in the code; further verification of the buffer layout and exploitability is needed. Dynamic testing is recommended to confirm the overflow. Associated function: main.", "file_path": "usr/sbin/pppd"}
{"name": "CommandInjection-route_functions", "location": "pppd:0x427e90 fcn.00427e90, pppd:0x428000 system call, pppd:0x428310 system call", "description": "In the fcn.00427e90 and sym.sifdefaultroute functions, system calls are used to execute route management commands. The command string is constructed via format strings and includes user-controllable parameters (such as IP addresses). If an attacker can control these parameters (for example, through malicious PPP configuration or network data), they can inject arbitrary commands. For instance, in fcn.00427e90, the %s placeholders in the command 'route del -host %s dev %s' may contain shell metacharacters (such as ; or `), leading to the execution of additional commands. Trigger condition: These functions are called when pppd handles route updates, and the parameters come from untrusted sources (such as network input). Potential attack method: An attacker sends malicious PPP packets or configurations, injecting commands like '; rm -rf / ;' to delete files or perform other actions. Constraints: Parameters may undergo some validation, but the code does not show input filtering. Since pppd runs as root, successful exploitation will result in root privileges.", "link_identifiers": ["NVRAM or configuration parameters"], "code_snippet": "// In fcn.00427e90:\n(**(loc._gp + -0x7d90))(auStack_a4,\"route del -host %s dev %s\",uVar3,*(loc._gp + -0x7bd4));\n(**(loc._gp + -0x7824))(auStack_a4);\n// In sym.sifdefaultroute:\n(**(loc._gp + -0x7824))(\"route del default\");\n(**(loc._gp + -0x7d90))(auStack_7c,\"route add default gw %s dev ppp0\",uVar3);\n(**(loc._gp + -0x7824))(auStack_7c);", "risk_score": 8.0, "confidence": 7.5, "notes": "Need to verify whether parameters uVar3 and *(loc._gp + -0x7bd4) are user-controllable. It is recommended to check network data processing functions to confirm the input source. Related functions: fcn.00427e90, sym.sifdefaultroute, and network protocol processing functions.", "file_path": "usr/sbin/pppd"}
{"name": "Stack-Buffer-Overflow-getargs", "location": "arp:0x00400e00 sym.getargs", "description": "In the sym.getargs function, using strcpy to copy user-input strings to a stack buffer lacks boundary checks, which may lead to a stack buffer overflow. Attackers can trigger this vulnerability by providing specially crafted file content to the 'arp -f' command (for example, a file containing a long string). Trigger conditions include: using the 'arp -f <file>' command, where the file content exceeds the stack buffer size. Potential exploitation methods include overwriting the return address or executing arbitrary code. However, since the 'arp' binary does not have the setuid bit, attackers may not be able to escalate privileges and can only execute code under the current user's permissions. Constraints: The buffer size is dynamically allocated on the stack, but strcpy does not validate the length.", "link_identifiers": ["File path: /etc/ethers (default file)", "Command line option: -f", "Environment variables: None", "Function symbols: sym.getargs, sym.arp_file"], "code_snippet": "0x00400df8      8f998024       lw t9, -sym.imp.strcpy(gp)  ; [0x405040:4]=0x8f998010\n0x00400dfc      00000000       nop\n0x00400e00      0320f809       jalr t9\n; strcpy is called, copying user input string to stack buffer", "risk_score": 6.0, "confidence": 8.0, "notes": "The vulnerability exists and is triggerable, but the 'arp' binary permissions are -rwxrwxrwx (no setuid bit), so exploitation may be limited to the current user's permissions. It is recommended to further verify actual exploitability, for example by testing whether the overflow overwrites the return address. Related file: sym.arp_file handles file input. Future analysis directions: Check for similar vulnerabilities in other functions (such as sym.arp_set) and evaluate whether they run with higher privileges in specific contexts (such as via sudo).", "file_path": "usr/arp"}
