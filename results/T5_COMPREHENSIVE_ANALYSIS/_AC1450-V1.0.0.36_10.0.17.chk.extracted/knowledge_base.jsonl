{"name": "command-injection-rc-main", "location": "rc:0x0000f4f8-0x0000f610 (main function)", "description": "A command injection vulnerability exists in the hotplug event handling code of the 'rc' binary. The NVRAM variable `lan_ifnames` is retrieved and used to construct a shell command via `_eval` without proper sanitization for shell metacharacters. When MODALIAS is 'platform:coma_dev', the code parses `lan_ifnames` for interface names and executes 'wl -i <interface> down'. An attacker with write access to `lan_ifnames` can inject malicious commands by including semicolons, backticks, or other metacharacters. For example, setting `lan_ifnames` to 'eth0; malicious_command' results in the execution of 'malicious_command' with root privileges. The trigger condition is a hotplug event with MODALIAS='platform:coma_dev', which could be induced by hardware events or potentially simulated by an attacker.", "link_identifiers": ["lan_ifnames", "_eval", "MODALIAS"], "code_snippet": "0x0000f4f8      ldr r0, str.lan_ifnames     ; 'lan_ifnames'\n0x0000f500      bl sym.imp.nvram_get        ; Get value from NVRAM\n...\n0x0000f524      mov r2, 0x20                ; 32 bytes\n0x0000f528      mov r1, sl                  ; Source string from NVRAM\n0x0000f52c      mov r0, r4                  ; Destination buffer\n0x0000f530      bl sym.imp.strncpy          ; Copy interface name\n...\n0x0000f5fc      str r8, [var_2ch]           ; 'wl'\n0x0000f600      str sb, [var_30h]           ; '-i'\n0x0000f604      str r4, [var_34h]           ; Interface name from buffer\n0x0000f608      str fp, [var_38h]           ; 'down'\n0x0000f60c      str ip, [var_3ch]           ; Null terminator\n0x0000f610      bl sym.imp._eval            ; Execute command", "risk_score": 7.5, "confidence": 8.0, "notes": "This vulnerability requires the attacker to have write access to the `lan_ifnames` NVRAM variable, which may be possible via web interfaces or CLI tools if access controls are weak. The hotplug event trigger might be exploitable through physical device insertion or other means. Further analysis is needed to confirm the availability of NVRAM write operations to non-root users and the frequency of 'platform:coma_dev' events. The use of `strncpy` with a fixed size limits the injection length to 32 bytes, but this is sufficient for many payloads. Additional vulnerabilities may exist in other command handlers (e.g., 'erase', 'write'), but this chain is the most directly exploitable.", "file_path": "sbin/rc"}
{"name": "Command Injection-fcn.0001a1c0", "location": "acos_service:0x1a1c0 fcn.0001a1c0 and acos_service:0x19ce8 fcn.00019ce8", "description": "A command injection vulnerability was discovered in function fcn.0001a1c0. When the number of parameters (param_1) is greater than 1, the function obtains user input from the command line argument (param_2[1]) and passes it to fcn.00019ce8. In fcn.00019ce8, the input is directly used in the sprintf format string 'ifconfig %s del %s/%s', which is then executed via system without any filtering or escaping. An attacker can execute arbitrary commands by injecting shell metacharacters (such as semicolons, backticks). Trigger condition: The attacker executes 'acos_service' and passes malicious parameters (e.g., via web interface or CLI), and NVRAM configuration checks (acosNvramConfig_match) might affect the path, but as a logged-in user, the attacker can manipulate settings or trigger it directly. Exploitation method: Construct parameters such as 'eth0; malicious_command', leading to command execution.", "link_identifiers": ["Command line argument via param_2", "NVRAM variables via acosNvramConfig_get and acosNvramConfig_match (e.g., *0x19ef4, *0x19f34)", "Function symbols: fcn.0001a1c0, fcn.00019ce8, sym.imp.system, sym.imp.sprintf", "Hardcoded string address: *0x19f30 (format string)"], "code_snippet": "// fcn.0001a1c0 snippet\nif (param_1 != 1 && param_1 + -1 < 0 == SBORROW4(param_1,1)) {\n    // ... NVRAM checks ...\n    fcn.00019ce8(*0x1a2c4, *(param_2 + 4)); // Pass user input\n}\n// fcn.00019ce8 snippet\nsym.imp.sprintf(puVar7 + -0x84, *0x19f30, param_2, uVar3); // param_2 is user input, format string is 'ifconfig %s del %s/%s'\nsym.imp.system(puVar7 + -0x84); // Execute the formatted command", "risk_score": 8.5, "confidence": 9.0, "notes": "The vulnerability has high exploitability: the attack chain is complete (from input point to command execution), and as a logged-in user, the attacker can likely trigger it via binary execution. It is recommended to further verify the parameter source (e.g., web backend calls), but current evidence is sufficient to confirm the risk. Other system calls (e.g., sym.imp.system(*0x1a2c8)) should also be checked.", "file_path": "sbin/acos_service"}
{"name": "Command Injection-fcn.00019f38", "location": "acos_service:0x19f38 fcn.00019f38", "description": "A command injection vulnerability was discovered in function fcn.00019f38. When param_1 is not equal to 3 and is less than 3, the function retrieves data from the user input structure (offsets 4 and 8 of param_2), uses sprintf to embed it into a command string (address *0x1a1b8), and then executes it via system. The input is not filtered, allowing an attacker to inject arbitrary commands. Trigger condition: depends on the param_1 value and NVRAM check (acosNvramConfig_match), but as a logged-in user, an attacker can potentially control the trigger path via parameters. Exploitation method: manipulate input parameters to contain malicious commands (e.g., 'eth0; rm -rf /'), leading to privilege escalation or device destruction.", "link_identifiers": ["User input structure via param_2", "NVRAM configuration via acosNvramConfig_match", "Hardcoded string address: *0x1a1b8 (format string)", "Function symbols: fcn.00019f38, sym.imp.system, sym.imp.sprintf"], "code_snippet": "// fcn.00019f38 snippet\nelse if (param_1 != 3 && param_1 + -3 < 0 == SBORROW4(param_1,3)) {\n    iVar1 = puVar7 + -0x100;\n    uVar5 = *(param_2 + 4);\n    uVar2 = *(param_2 + 8);\n    *(puVar7 + -0x108) = *(param_2 + 0xc);\n    sym.imp.sprintf(iVar1, *0x1a1b8, uVar5, uVar2); // User input embedded into command\n    sym.imp.printf(*0x1a1bc, iVar1);\n    sym.imp.system(iVar1); // Execute command\n    return 0;\n}", "risk_score": 7.5, "confidence": 7.0, "notes": "High exploitability, but requires more detailed verification of trigger conditions (e.g., specific impact of param_1 and NVRAM settings). The attack chain from input to command execution is complete, but confidence is slightly lower due to dependency conditions. Recommend analyzing the calling context to confirm attacker controllability.", "file_path": "sbin/acos_service"}
